if(!this.hasOwnProperty("wui")){this.wui={}}String.prototype.titlizer=function(a){var c=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;var b=/^(ap|WSO|NE|NW|SW|SE|NNE|ENE|NNW|WNW|SSW|WSW|SSE|ESE)$/i;return this.replace(/([^\W_]+[^\s-]*) */g,function(e,g,d,f){if(d>0&&d+g.length!==f.length&&g.search(c)>-1&&f.charAt(d-2)!==":"&&f.charAt(d-1).search(/[^\s-]/)<0){return e.toLowerCase()}if(g.substr(1).search(/[A-Z]|\../)>-1){if(a!==1){if(g.search(b)>-1){return e.toUpperCase()}return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}else{return e}}return e.charAt(0).toUpperCase()+e.substr(1)})};wui.global=this;(function(a,b){a.defined=function(d){return(typeof d!="undefined")};a.arrayContains=function(e,d){return(b.inArray(e,d)>-1)};a.limit=function(f,e,d){return Math.min(d,Math.max(e,f))};var c={};a.toggleVisibility=function(h,g){var g=b.extend(true,{},{group_id:"0",surpressSelf:false},g);if(!(g.group_id in c)){c[g.group_id]=[]}var j=c[g.group_id];if(b.inArray(h,j)<0){j.push(h)}for(var f=0;f<j.length;f++){var d=j[f];var e=b("#"+d);if(!e[0]){continue}else{if(d===h){if(g.skipSelf){}else{e.toggleClass("none")}}else{e.addClass("none")}}}};a.centerInWindow=function(g){var h=b(g);if(!h[0]){return}h.css({position:"absolute",top:0,left:0});var k=false;if(h.hasClass("none")){k=true;h.removeClass("none")}var e=h.outerWidth();var j=h.outerHeight();if(k){h.addClass("none")}var d=b(window).width();var m=b(window).height();var l=(m-j)/2;var f=(d-e)/2;h.css({top:l,left:f})};a.dropdown=function(d){this.options=b.extend(true,{selectorButton:null,selectorMenu:null,position:{my:"left top",at:"left bottom",of:null,offset:"0 0",collision:"none none"},delay:100,hoverClass:null},d?d:{});this.options.position.of=this.options.selectorButton;var e=b(this.options.selectorButton);var f=b(this.options.selectorMenu);b.data(f,"hover",false);var d=this.options;e.mouseenter(function(g){f.stop(true).show();e.addClass(d.hoverClass);f.addClass(d.hoverClass);if(!b.data(f,"hover")){f.css({position:"absolute",top:"0px",left:"0px","z-index":1000});f.position(d.position)}if(window.StickerPopUp){StickerPopUp.forceHide()}}).mouseleave(function(g){f.delay(d.delay).hide(0);e.removeClass(d.hoverClass);f.removeClass(d.hoverClass)});f.mouseenter(function(g){b.data(f,"hover",true);e.mouseenter()}).mouseleave(function(g){b.data(f,"hover",false);e.mouseleave()})};a.wuForm=function(f,g){var g=b.extend(true,{classNames:{selected:"selected"},selectors:{container:"label",checkbox:".wuCheckbox",radio:".wuRadio"}},g);var e;if(b.type(f)==="string"){e=b(f)}else{if(f instanceof b){e=f}else{console.error("invalid type of parameter");return}}function d(m,k){if(m.is("input[type=checkbox]")&&m.siblings(g.selectors.checkbox).length>0){var n=m.is(":checked");var j=m.closest(g.selectors.container);j.toggleClass(g.classNames.selected,n)}if(m.is("input[type=radio]")&&m.siblings(g.selectors.radio).length>0){if(k===true){var l=m.attr("name");var h=e.find("input[type=radio][name="+l+"]")}else{var h=m}h.each(function(p){var r=b(this);if(r.siblings(g.selectors.radio).length>0){var q=r.is(":checked");var o=r.closest(g.selectors.container);o.toggleClass(g.classNames.selected,q)}})}}e.on("click","input",function(j){var h=b(j.target);d(h,true)});e.on("change","select[data-autosubmit]",function(h){e.submit()});e.on("click","input[data-autosubmit][type=checkbox], input[data-autosubmit][type=radio]",function(h){e.submit()});e.on("change","select[data-redirect]",function(k){var h=b(k.target);var j=h.val();if(j){window.location=j}});e.find("input").each(function(h){d(b(this),false)});e.find(".ui-buttonset").buttonset();e.on("click","input[data-toggle]",function(l){var m=b(l.target);var k=m.is(":checked");var j=m.attr("data-toggle")||"";var h=b(j);if(j&&h[0]){h.toggle(!!k)}});e.on("click","input[data-togglepref]",function(l){var m=b(l.target);var k=m.is(":checked");var j=m.attr("data-togglepref")||"";var h=k?1:0;if(j){a.prefs.set(j,h)}})};a.wuForm.buttonGroup={select:function(g,h){var h=b.extend(true,{classNames:{selected:"selected"},selectors:{button:".button",buttonGroup:".button-group"}},h);var e=b(g);var f=e.closest(h.selectors.buttonGroup);var d=f.find(h.selectors.button);d.not(g).removeClass(h.classNames.selected);e.addClass(h.classNames.selected)}};if(b.tablesorter){b.tablesorter.addParser({id:"englishNumber",is:function(d,e){return false},format:function(d){return b.tablesorter.formatFloat(d.replace(new RegExp(/[,]/g),""))},type:"numeric"})}})(wui,jQuery);(function(a,b){a.geolocation=function(){if(navigator&&navigator.geolocation){navigator.geolocation.getCurrentPosition(c)}function c(d){var f=d.coords.latitude;var g=d.coords.longitude;if(a.geolocation.getURL){var e=a.geolocation.getURL(f,g);if(e.length>1){window.location=e}}else{window.location.search="query="+f+","+g}}}})(wui,jQuery);(function(a,c){var b={};a.log=function(d){a.log.write(d)};a.log.initialize=function(){b.container=c("<div></div>").addClass("wui-log").appendTo(document.body).css({position:"absolute",bottom:"1em",left:"1em"});b.container_head=c("<div></div>").addClass("wui-log-head").appendTo(b.container).html("wui.log");b.container_body=c("<div></div>").addClass("wui-log-body").appendTo(b.container);b.container_table=c('<table cellspacing="0" cellpadding="0"></table>').appendTo(b.container_body);b.container_thead=c("<thead></thead>").appendTo(b.container_table);b.container_tbody=c("<tbody></tbody>").appendTo(b.container_table);var d=c("<a></a>").addClass("wui-log-close").appendTo(b.container_head).html("X");d.attr("href","javascript:void(0);");d.click(function(f){f.preventDefault();a.log.remove()});b.container.draggable({handle:b.container_head});b.initialized=true};a.log.write=function(g){if(!b.initialized){a.log.initialize()}var e=new Date();var d=((e.getMilliseconds()/1000).toFixed(3)+"").substr(2);var f='<tr class="wui-log-row"><td class="wui-log-time">'+e.toLocaleTimeString()+"."+d+"</td><td>"+g+"</td></tr>";b.container_tbody.append(f);var h=b.container_body[0].scrollHeight;b.container_body.scrollTop(h)};a.log.console=function(){var f=new Date();var e=((f.getMilliseconds()/1000).toFixed(3)+"").substr(2);var d=f.toLocaleTimeString()+"."+e};a.log.remove=function(){b.container.remove();b.initialized=false}})(wui,jQuery);(function(a,b){var c={};a.history={};a.history.toQueryString=function(){var g="#";var d=[];for(var e in c){if(c.hasOwnProperty(e)){var f=c[e];d.push(e+"="+encodeURIComponent(f))}}if(d.length>0){g+="?"+d.join("&")}return g};a.history.setKey=function(d,e){c[d]=e};a.history.getKey=function(d){return c[d]};a.history.replace=function(){var d=a.history.toQueryString();window.location.replace(d)};a.history.update=function(){var d=a.history.toQueryString();window.location=d};a.history.parse=function(){var j=window.location.hash;if(j.length>2&&j.charAt(0)=="#"&&j.charAt(1)=="?"){j=j.substr(2);var d=j.split("&");for(var f=0;f<d.length;f++){var g=d[f].split("=",2);var e=g[0];var h=decodeURIComponent(g[1]);c[e]=h}}};a.history.parse()})(wui,jQuery);(function(b,c){var a=[];var d=false;b.stickyscroll={};b.stickyscroll.add=function(e){var f=c.extend(true,{elt:null,top:0,until:0,isPosFixed:false,isPosAbsolute:false,change:null},e?e:{});var g=parseFloat(f.elt.css("margin-top"))||0;f.originalTopOffset=f.elt.offset().top-f.top-g;if(f.until){f.originalBottomOffset=f.until-f.elt.outerHeight()}else{f.originalBottomOffset=c(document).height()-f.elt.outerHeight()-g}f.originalPosition=f.elt.css("position");f.originalTop=f.elt.css("top");a.push(f);b.stickyscroll.refresh()};b.stickyscroll.refresh=function(){if(!d&&a.length>0){d=true;c(window).bind("scroll.stickyscroll",function(){var e=c(window).scrollTop();for(var f=0;f<a.length;f++){var g=a[f];if(g.until>0&&e>g.originalBottomOffset){if(g.isPosAbsolute){continue}g.isPosFixed=false;g.isPosAbsolute=true;g.elt.css({position:"absolute",top:g.originalBottomOffset});if(g.change){g.change.call(g.elt,2,"absolute")}}else{if(e>g.originalTopOffset){if(g.isPosFixed){continue}g.isPosFixed=true;g.isPosAbsolute=false;g.elt.css({position:"fixed",top:g.top});if(g.change){g.change.call(g.elt,1,"fixed")}}else{if(e<g.originalTopOffset){if(!g.isPosFixed&&!g.isPosAbsolute){continue}g.isPosFixed=false;g.isPosAbsolute=false;g.elt.css({position:g.originalPosition,top:g.originalTop});if(g.change){g.change.call(g.elt,0,g.originalPosition)}}}}}})}};b.stickyscroll.removeAll=function(){c(window).unbind("scroll.stickyscroll");a=[];d=false}})(wui,jQuery);(function(c,d){if(typeof window.matchMedia=="undefined"){return}var b="unknown";function a(){var e="unknown";if(window.matchMedia("(max-width: 640px)").matches){e="small"}else{if(window.matchMedia("(min-width: 641px)").matches&&window.matchMedia("(max-width: 1024px)").matches){e="medium"}else{if(window.matchMedia("(min-width: 1025px)").matches&&window.matchMedia("(max-width: 1280px)").matches){e="large"}else{if(window.matchMedia("(min-width: 1281px)").matches&&window.matchMedia("(max-width: 1920px)").matches){e="xlarge"}else{if(window.matchMedia("(min-width: 1921px)").matches){e="xxlarge"}else{e="unknown"}}}}}return e}d(b=a());d(window).bind("resize",function(f){var e=a();if(e==b){return}if(e=="small"){d(window).trigger("switched-to-small")}else{if(e=="medium"){d(window).trigger("switched-to-medium")}else{if(e=="large"){d(window).trigger("switched-to-large")}else{if(e=="xlarge"){d(window).trigger("switched-to-xlarge")}else{if(e=="xxlarge"){d(window).trigger("switched-to-xxlarge")}}}}}if(b=="small"){d(window).trigger("switched-from-small")}else{if(b=="medium"){d(window).trigger("switched-from-medium")}else{if(b=="large"){d(window).trigger("switched-from-large")}else{if(b=="xlarge"){d(window).trigger("switched-from-xlarge")}else{if(b=="xxlarge"){d(window).trigger("switched-from-xxlarge")}}}}}b=e})})(wui,jQuery);(function(a,b){a.pushdown={};a.pushdown.enlarge=function(c){b("#bannerTop").css("overflow","hidden");if(!c){b("#bannerTop").height(418)}else{b("#bannerTop").height(c)}};a.pushdown.collapse=function(c,d){b("#bannerTop").css("overflow","hidden");if(!c){b("#bannerTop").height(66)}else{b("#bannerTop").height(c)}if(d!=1){b("#bannerTop").addClass("stopover")}};a.pushdown.enlargeWithTracking=function(e,d,c){b("#bannerTop").css("overflow","hidden");b("#bannerTop").append("<div id='"+e+"'><img src='"+d+"' border='0'></div>");if(!c){b("bannerTop").height(418)}else{b("bannerTop").height(c)}};a.pushdown.collapseWithTracking=function(d,c){b("#bannerTop").css("overflow","hidden");b("#bannerTop").find("#"+d).remove();if(!c){b("bannerTop").height(66)}else{b("bannerTop").height(c)}}})(wui,jQuery);(function(a,b){a.prefs={};a.prefs.set=function(d,e,f){var f=f||function(){};var c={};c[d]=e;return a.prefs.setMany(c,f)};a.prefs.setMany=function(d,g){var e=0;var f={};for(var c in d){f["setprefs."+e+".key"]=c;f["setprefs."+e+".val"]=d[c];e++}b.ajax({url:"/auto/wui/geo/PrefDump/index.html",type:"POST",cache:false,data:f,dataType:"html",error:function(k,h,j){a.log("Error: failed to save preferences")},complete:function(){g&&g()}})}})(wui,jQuery);(function(a,b){a.storage={};a.storage.setLocal=function(c,f){try{if(typeof Storage!=="undefined"&&typeof localStorage!=="undefined"){localStorage.setItem(c,f);return true}else{console.log("cannot set key:"+c+" - storage undefined");return false}}catch(d){console.log("Local Storage error: "+d+" cannot set "+c);return false}};a.storage.setManyLocal=function(d){for(var c in d){a.storage.setLocal(c,d[c])}};a.storage.getLocal=function(c){try{if(typeof Storage!=="undefined"&&typeof localStorage!=="undefined"){var f=localStorage.getItem(c);return f}else{console.log("cannot get key:"+c+" - storage undefined");return null}}catch(d){console.log("Local Storage error: "+d+" cannot get "+c);return null}};a.storage.removeFromLocal=function(c){try{if(typeof Storage!=="undefined"&&typeof localStorage!=="undefined"){localStorage.removeItem(c);return true}else{console.log("cannot remove key:"+c+" - storage undefined");return false}}catch(d){console.log("Local Storage error: "+d+" cannot remove "+c);return false}};a.storage.removeManyFromLocal=function(c){for(var d in c){a.storage.removeFromLocal(d)}};a.storage.setSession=function(c,f){try{if(typeof Storage!=="undefined"&&typeof sessionStorage!=="undefined"){sessionStorage.setItem(c,f);return true}else{console.log("cannot set key:"+c+" - storage undefined");return false}}catch(d){console.log("Session Storage error: "+d+" cannot set "+c);return false}};a.storage.setManySession=function(d){for(var c in d){a.storage.setSession(c,d[c])}};a.storage.getSession=function(c){try{if(typeof Storage!=="undefined"&&typeof sessionStorage!=="undefined"){var f=sessionStorage.getItem(c);return f}else{console.log("cannot get key:"+c+" - storage undefined");return null}}catch(d){console.log("Session Storage error: "+d+" cannot get "+c);return null}};a.storage.removeFromSession=function(c){try{if(typeof Storage!=="undefined"&&typeof sessionStorage!=="undefined"){sessionStorage.removeItem(c);return true}else{console.log("cannot remove key:"+c+" - storage undefined");return false}}catch(d){console.log("Session Storage error: "+d+" cannot remove "+c);return false}};a.storage.removeManyFromSession=function(c){for(var d in c){a.storage.removeFromSession(d)}}})(wui,jQuery);(function(a,c){var b={};a.fullscreen={active:false,supported:d()};a.fullscreen.enter=function(e){var e=e||document.documentElement;if(e.requestFullScreen){e.requestFullscreen()}else{if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else{if(e.webkitRequestFullScreen){e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}}}};a.fullscreen.exit=function(){if(document.cancelFullScreen){document.cancelFullScreen()}else{if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}}}}};a.fullscreen.isFullScreen=function(){return(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen)?true:false};c(document).bind("fullscreenchange mozfullscreenchange webkitfullscreenchange",function(){a.fullscreen.active=a.fullscreen.isFullScreen()});function d(){var e=document.documentElement;return(("requestFullscreen" in e)||("mozRequestFullScreen" in e&&document.mozFullScreenEnabled)||("webkitRequestFullScreen" in e))?true:false}})(wui,jQuery);(function(b,c){function a(){var d=document.createElement("canvas");var e=!!(window.navigator.appVersion.indexOf("MSIE")>=0&&window.navigator.appName.indexOf("Internet Explorer")>=0);return !!(d.getContext&&d.getContext("2d")&&!e)}b.status={online:false,getOnline:function(){return !("navigator" in window&&window.navigator.onLine===false)},canvasSupported:a()};b.status.online=b.status.getOnline()})(wui,jQuery);wui.member={};wui.member.logged_in=function(){return jQuery("meta[name=wui-member-logged-in]").attr("content")==="true"};(function(b,c){b.numberWithCommas=function(d){var e=d.toString().split(".");e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return e.join(".")};var a={};b.setTimeout=function(f,e){var d=new Date();var g=window.setTimeout(f,e);a[g]={start:d.getTime(),end:d.getTime()+e,delay:e,poll:null};return g};b.clearTimeout=function(e){var d=a[e];if(!d){b.log("Error: unknown timeoutID: "+e);return}b.setTimeout.poll(e,false);window.clearTimeout(e);delete a[e]};b.setTimeout.poll=function(f,d,h){var e=a[f];if(!e){b.log("Error: unknown timeoutID: "+f);return}if(d===0||d===false){if(e.poll){window.clearInterval(e.poll);e.poll=null}return}var g=window.setInterval(function(){var k=new Date();var l=e.end-k.getTime();var j=k.getTime()-e.start;if(l>0){if(!h){h=b.setTimeout.log}h(l,j)}else{window.clearInterval(g);e.poll=null}},d);e.poll=g;return g};b.setTimeout.timeouts=a;b.setTimeout.log=function(e,d){b.log("time remaining: "+e+" ms")};b.getParameterByName=function(d){d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=new RegExp("[\\?&]"+d+"=([^&#]*)"),e=f.exec(location.search);return e===null?"":decodeURIComponent(e[1].replace(/\+/g," "))}})(wui,jQuery);(function(b,d){var e=null;var a=null;var c=null;var f=null;if(window.navigator.msPointerEnabled){e="mouseenter";a="mouseleave";c="click";f="click"}else{e="mouseenter";a="mouseleave";c="click";f="touchstart"}b.featuremenu=function(){var g=false;d("#featureMenu").bind(e,function(){g=true});d("#featureMenu").bind(a,function(){g=false});closefeedback=function(){if(g==false){d("#uberVoice").css("display","none")}};showfeedback=function(){d("#uberVoice").css("display","inline")};b.featuremenu.closemenus=function(){var h=new d.Deferred();d(".featureGroup","#featureMenu").each(function(){if(!d(this).hasClass("activetab")){d(this).removeClass("activeGroup")}d(".fullList",d(this)).addClass("menuHide").removeClass("menuShow")});closefeedback();h.resolve("Finished");return h.promise()};d("#uberVoice").bind(c,function(){b.featuremenu.closemenus();d("#uberVoice").css("display","none")});if(!window.navigator.msPointerEnabled){d(document).bind(c,function(){if(g==false){b.featuremenu.closemenus()}})}d(document).bind(f,function(h){if(d("#featureMenu").has(h.target).length==0){b.featuremenu.closemenus();d(".groupTitle").css("background-color","")}});d(".featureGroup","#featureMenu").each(function(){var j=d(this);var m=d(".groupTitle",d(this));var l=d(".fullList",d(this));var k=false;var n=null;var h=null;if(!d(this).hasClass("activeGroup")){k=true}else{d(this).addClass("activetab")}d(this).bind(e,function(){clearInterval(h);m.css("background-color","#EBEEF6");if(k){j.removeClass("activeGroup").addClass("activeGroup")}});m.bind(e,function(){var o=0;if(g==true){o=150}else{o=250}n=setInterval(function(){var p=b.featuremenu.closemenus();clearInterval(n);p.done(function(){l.removeClass("menuHide").addClass("menuShow");showfeedback();if(k){j.removeClass("activeGroup").addClass("activeGroup")}})},o)});d(this).bind(a,function(){var o=0;if(g==false){o=150}else{o=250}m.css("background-color","");clearInterval(n);if(k){j.removeClass("activeGroup")}h=setInterval(function(){clearInterval(h);l.addClass("menuHide").removeClass("menuShow");closefeedback()},o)});m.bind(c,function(p){if(l.hasClass("menuShow")){}else{p.preventDefault();var o=b.featuremenu.closemenus();o.done(function(){l.removeClass("menuHide").addClass("menuShow");if(k){j.addClass("activeGroup")}})}})})}})(wui,jQuery);(function(a,b){a.Analytics={prefix:"WUI_",debug:0,sendClickEvent:function(d,c,e){this.sendOmnitureClickEvent(d,c,e)},sendOmnitureClickEvent:function(e,d,f){if(s_pageAction&&s&&b.isFunction(s.tl)&&b.isFunction(s.t)){var c=this.prefix;if(e&&e.length>0){c+=e}if(d&&d.length>0){c+="_"+d}if(f===true){c+="_on"}if(f===false){c+="_off"}if(this.debug){console.log("Analytics tag: "+c)}else{s_pageAction(c)}}}}})(wui,jQuery);(function(a,b){a.tools={};a.tools.domainShardSuffix=function(g,f){var e=0;if(g.length==0){return e+1}for(var d=0;d<g.length;d++){var c=g.charCodeAt(d);e=((e<<5)-e)+c;e=e&e;if(e<0){e=-e}}return((parseInt(e)%f))+1}})(wui,jQuery);(function(a,b){a.SetUnitToEnglish=function(){window.location="/cgi-bin/findweather/getForecast?setunits=english&referer="+window.location.href};a.SetUnitToMetric=function(){window.location="/cgi-bin/findweather/getForecast?setunits=metric&referer="+window.location.href};a.SetDebugOn=function(){window.location="/php/setdebug.php?debug=1&referer="+window.location.href};a.SetDebugOff=function(){window.location="/php/setdebug.php?debug=0&referer="+window.location.href}})(wui,jQuery);(function(b,d){var c={};b.autocomplete=function(e){this.options=d.extend(true,{input:null,appendTo:null,autosubmit:false,autoFocus:false,captureFormSubmit:false,className:"",classNames:{cityStar:"city-star",isFav:"is-fav",menu:""},data:{h:"1"},exclude:[],getItemContent:null,getItemTemplate:"script#autocomplete_item_template",includeFavorites:false,includeGeoLocate:false,includeHeaderGeoLocate:false,includePWS:false,includeRecents:true,isMainSearchBox:false,includeOnlyCities:false,includeOnlyUS:false,minLength:1,maxResults:0,onBeforeSelect:d.noop,onOpen:d.noop,onSelect:d.noop,search:"",select:null,showConditions:false,showFavoriteStars:false,submitButton:null,suffix:d.noop,url:"",zipCodeOnly:false},e?e:{});this.input=d(this.options.input);this.select=d(this.options.select);this.hasSelect=(this.select&&this.select.length>0);this._cache=[];this._template=null;this.initialize()};b.autocomplete.prototype.getInstance=function(){var e=this.input.data("ui-autocomplete")||this.input.data("autocomplete");return e};var a=function(f){var e=f.data("ui-autocomplete-item")||f.data("item.autocomplete");return e};b.autocomplete.prototype.initialize=function(){var g=this.input;var j=this.hasSelect;var h=this.options;var f=this;if(!g[0]){return}var k=null;if(h.getItemContent){k=h.getItemContent}else{if(h.showConditions||h.showFavoriteStars){k=this.getItemContent}}if(k){this._template=_.template(d(h.getItemTemplate).html())}this.input.autocomplete({source:function(n,m){var o=/^\d+$/.test(n.term.substr(0,5));if(h.zipCodeOnly&&!o){m(function(){return false})}else{if(n.term.length==0){var l=f.getFilteredItems(n);m(l)}else{d.ajax({url:h.url||b.autocomplete._config.url,dataType:"jsonp",jsonp:"cb",data:d.extend(true,{},{query:n.term},h.data),success:function(q){if(!q||!q.RESULTS){var p=f.getFilteredItems(n)}else{var p=f.getFilteredItems(n,q.RESULTS);f._cache=q.RESULTS}m(p)},error:function(){var p="Could not search for your location. Please check your internet connection and try again.";b.log(p)}})}}},search:function(m,n){f._cache=[];var l=d(this).autocomplete("option","disabled");if(l){return false}},select:function(m,n){if(n.item){var o=h.onBeforeSelect(m,this.value,n.item);if(o===false){return false}this.value=n.item.zip||n.item.value;if(j){this._updateSelectMenu(n.item.type)}if(h.submitButton){d(h.submitButton).unbind("click").click(function(){var p=n.item.zip||n.item.value;if(h.autosubmit==="localclimate"){window.location="/climate/local.html?query="+p}else{if(h.autosubmit==="sitewidealerts"){siteWideAlertsSubmit(p)}else{if(h.autosubmit==="extremes"){window.location="/climate/local_extremes.asp?query="+p}else{if(h.autosubmit==="form"){this.form.submit()}else{if(n.item.type=="pws"){window.location="/personal-weather-station/dashboard?ID="+p.toUpperCase()}else{if(n.item.l){window.location=n.item.l}else{if(h.isMainSearchBox&&n.item.wmo){window.location="/global/stations/"+n.item.wmo+".html"}else{if(h.isMainSearchBox&&window.SubmitFastForecastSearch){window.SubmitFastForecastSearch()}else{this.form.submit()}}}}}}}}})}if(h.autosubmit){var l=n.item.zip||n.item.value;if(h.autosubmit==="localclimate"){window.location="/climate/local.html?query="+this.value}else{if(h.autosubmit==="sitewidealerts"){siteWideAlertsSubmit(l)}else{if(h.autosubmit==="extremes"){window.location="/climate/local_extremes.asp?query="+this.value}else{if(h.autosubmit==="form"){this.form.submit()}else{if(h.autosubmit==="formzmw"){g.val("zmw:"+n.item.zmw);this.form.submit()}else{if(n.item.type=="pws"){window.location="/personal-weather-station/dashboard?ID="+this.value.toUpperCase()}else{if(n.item.l){window.location=n.item.l}else{if(h.isMainSearchBox&&n.item.wmo){window.location="/global/stations/"+n.item.wmo+".html"}else{if(h.isMainSearchBox&&window.SubmitFastForecastSearch){window.SubmitFastForecastSearch()}else{this.form.submit()}}}}}}}}}}h.onSelect(this.value,n.item)}},appendTo:h.appendTo,open:h.onOpen,minLength:h.minLength,autoFocus:h.autoFocus});var e=this.getInstance();e._renderMenu=function(n,m){var l=this;var o="";d.each(m,function(q,r){if(r.type!=o){var p=b.autocomplete._config.groupTitles[r.type]||r.type;p=p.replace("_"," ");n.append("<li class='ui-autocomplete-group'>"+p+"</li>");o=r.type}l._renderItem(n,r)});n.append('<li class="ui-autocomplete-last"><a href="/member/membersettings.html?page=favorites">Manage Favorite Cities</a></li>')};e._renderItem=function(m,n){var o=null;if(k){var l=k(n,f._template,h);o=d(l)}else{o=d("<li></li>").append(d("<a></a>").html(n.label))}o.data("ui-autocomplete-item",n).data("item.autocomplete",n).appendTo(m);return o};this.input.autocomplete("widget").addClass(h.className).addClass(h.classNames.menu);if(j){this.select.change(this._updateEnabledState);this._updateEnabledState()}if(h.captureFormSubmit){this.captureFormSubmit()}if(h.showFavoriteStars){this.setupFavoriteStars()}if(h.search){this.input.autocomplete("search",h.search)}else{if(this.input.is(":focus")){this.input.autocomplete("search")}}if(h.minLength===0){this.input.focus(function(){if(this.value.length==0){d(this).autocomplete("search")}})}};b.autocomplete.prototype.getFilteredItems=function(g,n){var k=[];var p=this.options;if(p.includeGeoLocate&&!g.term.length){var f={name:"Current Location",task:"geolocate",type:""};k=k.concat(f)}if(p.includeHeaderGeoLocate&&!g.term.length){var o=b.bootstrapped&&b.bootstrapped.pageType&&b.bootstrapped.pageType==="WunderMap"?"Find My Location":"Find Nearest Station";var j={name:o,task:"headerGeolocate",type:""};k=k.concat(j)}if(p.includeFavorites){var l=[];if(b.page&&b.page.collections.favorites){l=b.page.collections.favorites.toJSON()}else{if(b.favorites.items){l=b.favorites.items.getList()}}l=b.autocomplete.filter(l,g.term);k=k.concat(l)}if(p.includeRecents){var h=[];if(b.page&&b.page.collections.recents){h=b.page.collections.recents.toJSON()}else{if(b.recents){h=b.recents}else{h=b.autocomplete._config.items}}h=b.autocomplete.filter(h,g.term);k=k.concat(h)}if(n&&n.length){k=k.concat(n)}var e=0;var m=d.map(k,function(z,v){if(p.maxResults&&e>=p.maxResults){return null}var t=g.term.length;var q=z.name;var w=z.type;var x;if(!p.includePWS&&w=="pws"){return null}if(d.inArray(w,p.exclude)>=0){return null}if(p.includeOnlyUS&&z.c!=="US"){return null}if(p.includeOnlyCities){var y=w==="city"||w==="favorite";if(!y){return null}}if(p.zipCodeOnly){x=q.substr(0,5)}else{if(w=="pws"){x=q.split(",",1)[0]}else{if(w=="recent"){x=q}else{x=q}}}var u=p.suffix(x,z)||"";var r=d.extend(true,{},z,{label:'<span class="ui-autocomplete-term">'+q.substr(0,t)+"</span>"+q.substr(t)+u,value:x});e++;return r});return m};b.autocomplete.prototype.destroy=function(){if(!this.input[0]){return}this.input.autocomplete("destroy")};b.autocomplete.prototype.captureFormSubmit=function(){var e=this.input;if(!this.input[0]){return}var f=d(this.input[0].form);f.submit(function(g){e.autocomplete("search",e.val());g.preventDefault()})};b.autocomplete.prototype._updateEnabledState=function(){var e=this.select.val().toLowerCase();if(e=="weather"||e=="pws"){this.input.autocomplete("option","disabled",false);b.autocomplete.setNative(this.input,false)}else{this.input.autocomplete("option","disabled",true);b.autocomplete.setNative(this.input,true)}};b.autocomplete.prototype._updateSelectMenu=function(e){if(e=="city"){this.select.val("WEATHER")}else{if(e=="pws"){this.select.val("PWS")}}};b.autocomplete.prototype.refresh=function(){var h=this.input.val();var g={term:h};var f=this.getFilteredItems(g,this._cache);var e=this.getInstance();f=e._normalize(f);e._suggest(f)};b.autocomplete.prototype.refreshIfOpen=function(){var f=this.input.autocomplete("widget");var e=f.is(":visible");if(e){this.refresh()}};b.autocomplete.prototype.getItemContent=function(h,g,e){var j=e.showFavoriteStars&&!!(h.zmw)&&(h.type!="country");var f=g({item:h,isCity:j,isFav:b.page.collections.favorites.hasZMW(h.zmw),hasConds:(e.showConditions&&!!(h.condition))});return f};b.autocomplete.prototype.setupFavoriteStars=function(){var e=this;var f=this.input.autocomplete("widget");var h=this.options.classNames;var g=null;if(b.page&&b.page.collections.favorites){g=b.page.collections.favorites}f.on("click","."+h.cityStar,function(l){var j=f[0];var m=d(this).closest(".ui-menu-item",j);var k=a(m);if(!k){return false}if(g){g.toggleFavorite(k.zmw)}return false});if(g){g.on("add remove",this.refreshIfOpen,this)}};b.autocomplete.setNative=function(e,f){if(f===false){e.addClass("ui-autocomplete-input").attr({autocomplete:"off",role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"})}else{if(f===true){e.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup")}}};b.autocomplete._config={items:[],groupTitles:{},url:"//autocomplete.wunderground.com/aq"};b.autocomplete.addItems=function(e){b.autocomplete._config.items=b.autocomplete._config.items.concat(e)};b.autocomplete.setGroupTitles=function(e){b.autocomplete._config.groupTitles=e};b.autocomplete.setUrl=function(e){b.autocomplete._config.url=e};b.autocomplete.filter=function(g,e){var f=new RegExp("^"+d.ui.autocomplete.escapeRegex(e),"i");return d.grep(g,function(h){return f.test(h.name)})}})(wui,jQuery);(function(g,e){g.date={};g.date.pad=function(q,l,p){var m=""+q;l=l||2;p=p||"0";for(var o=l-m.length;o>0;o--){m=p+m}return m};g.date.toTwelveHour=function(l){if(l==0){return 12}else{if(l>12){return(l-12)}else{return l}}};g.date.isValid=function(l){return !isNaN(l.getTime())};g.date.days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];g.date.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var h={second:function(l,m){l.setUTCSeconds(l.getUTCSeconds()+m);return l},minute:function(l,m){l.setUTCMinutes(l.getUTCMinutes()+m);return l},hour:function(l,m){l.setUTCHours(l.getUTCHours()+m);return l},day:function(l,m){l.setUTCDate(l.getUTCDate()+m);return l},week:function(l,m){l.setUTCDate(l.getUTCDate()+7*m);return l},month:function(m,o){var l=new Date(m.getTime());l.setUTCMonth(l.getUTCMonth()+o);if(m.getUTCMonth()==l.getUTCMonth()){m.setUTCDate(0)}else{m.setUTCMonth(m.getUTCMonth()+o)}return m},year:function(l,m){l.setUTCFullYear(l.getUTCFullYear()+m);return l},decade:function(l,m){l.setUTCFullYear(l.getUTCFullYear()+10*m);return l},century:function(l,m){l.setUTCFullYear(l.getUTCFullYear()+100*m);return l}};g.date.increment=function(m,o,l){if(!m){m=new Date()}return h[l](m,o)};var d={second:function(l,m){l.setUTCSeconds(l.getUTCSeconds()-m);return l},minute:function(l,m){l.setUTCMinutes(l.getUTCMinutes()-m);return l},hour:function(l,m){l.setUTCHours(l.getUTCHours()-m);return l},day:function(l,m){l.setUTCDate(l.getUTCDate()-m);return l},week:function(l,m){l.setUTCDate(l.getUTCDate()-7*m);return l},month:function(m,o){var l=new Date(m.getTime());l.setUTCMonth(l.getUTCMonth()-o);if(m.getUTCMonth()==l.getUTCMonth()){m.setUTCDate(1)}else{m.setUTCMonth(m.getUTCMonth()-o)}return m},year:function(l,m){l.setUTCFullYear(l.getUTCFullYear()-m);return l},decade:function(l,m){l.setUTCFullYear(l.getUTCFullYear()-10*m);return l},century:function(l,m){l.setUTCFullYear(l.getUTCFullYear()-100*m);return l}};g.date.decrement=function(m,o,l){if(!m){m=new Date()}return d[l](m,o)};var f={millisecond:function(l){return l.getUTCMilliseconds()},second:function(l){return l.getUTCSeconds()},minute:function(l){return l.getUTCMinutes()},hour:function(l){return l.getUTCHours()},day:function(l){return l.getUTCDate()},month:function(l){return l.getUTCMonth()+1},year:function(l){return l.getUTCFullYear()}};var b={second:function(l,m){l.setUTCSeconds(m);return l},minute:function(l,m){l.setUTCMinutes(m);return l},hour:function(l,m){l.setUTCHours(m);return l},day:function(l,m){l.setUTCDate(m);return l},month:function(l,m){l.setUTCMonth(m-1);return l},year:function(l,m){l.setUTCFullYear(m);return l}};g.date.create=function(p,o,m){if(m){var l=new Date(m.getTime());return g.date.increment(l,p,o)}else{return g.date.increment(null,p,o)}};g.date.createFunction=function(m,l){return function(){return g.date.increment(null,m,l)}};g.date.floor=function(l,n){if(!l){l=new Date()}var m=new Date(l.getTime());switch(n){case"century":m.setUTCFullYear(Math.floor(m.getUTCFullYear()/100)*100);case"decade":m.setUTCFullYear(Math.floor(m.getUTCFullYear()/10)*10);case"year":m.setUTCMonth(0);case"month":m.setUTCDate(1);case"day":m.setUTCHours(0);case"hour":m.setUTCMinutes(0);case"minute":m.setUTCSeconds(0);case"second":m.setUTCMilliseconds(0)}return m};g.date.roundTo=function(m,q,o){if(!m){m=new Date()}var p=g.date.roundDownTo(m,q,o);var l=g.date.roundUpTo(m,q,o);if(m-p<l-m){return p}else{return l}};g.date.roundDownTo=function(l,q,p){if(!l){l=new Date()}var o=f[p](l);o=Math.floor(o/q)*q;var m=g.date.floor(l,p);return b[p](m,o)};g.date.roundUpTo=function(l,q,p){if(!l){l=new Date()}var o=f[p](l);o=Math.ceil((o+0.5)/q)*q;var m=g.date.floor(l,p);return b[p](m,o)};var c=g.date.pad;var k=g.date.toTwelveHour;var j=g.date.days;var a=g.date.months;g.date.strftime=function(o,l,m){var q=null;if(l&&e.isPlainObject(l)){if("epoch" in l){var n=parseFloat(l.epoch)*1000;if(m===false){}else{if("tz_offset_hours" in l){var p=parseFloat(l.tz_offset_hours);n+=(p*3600*1000);m=true}}q=new Date(n)}}else{q=l||new Date()}return g.date.strftime.parse_(o,q,m)};g.date.strftime.conversions_={a:function(l){return j[l.getDay()]},b:function(l){return a[l.getMonth()]},c:function(l){return l.toString()},d:function(l){return c(l.getDate())},D:function(l){return""+l.getDate()},H:function(l){return c(l.getHours())},I:function(l){return c(k(l.getHours()))},k:function(l){return""+l.getHours()},l:function(l){return""+k(l.getHours())},m:function(l){return c(l.getMonth()+1)},n:function(l){return""+(l.getMonth()+1)},M:function(l){return c(l.getMinutes())},p:function(l){return(l.getHours()<12)?"AM":"PM"},P:function(l){return(l.getHours()<12)?"am":"pm"},s:function(l){return c(l.getTime()/1000)},S:function(l){return c(l.getSeconds())},w:function(l){return c(l.getDay())},x:function(l){return l.toLocaleDateString()},X:function(l){return l.toLocaleTimeString()},y:function(l){return c(l.getFullYear()%100)},Y:function(l){return""+l.getFullYear()},z:function(o){var n=o.getTimezoneOffset();var m=Math.floor(Math.abs(n/60));var p=Math.abs(n%60);var l=(n<0)?"+":"-";return l+c(m)+c(p)},Z:function(l){var m=l.toString().replace(/^.*:\d\d( GMT[+-]\d+)? \(?([A-Za-z ]+)\)?\d*$/,"$2").replace(/[a-z ]/g,"");if(m.length>4){m=g.date.strftime.conversions_.z(l)}return m},"%":function(l){return"%"}};g.date.strftime.conversions_utc_={a:function(l){return j[l.getUTCDay()]},b:function(l){return a[l.getUTCMonth()]},c:function(l){return l.toUTCString()},d:function(l){return c(l.getUTCDate())},D:function(l){return""+l.getUTCDate()},H:function(l){return c(l.getUTCHours())},I:function(l){return c(k(l.getUTCHours()))},k:function(l){return""+l.getUTCHours()},l:function(l){return""+k(l.getUTCHours())},m:function(l){return c(l.getUTCMonth()+1)},n:function(l){return""+(l.getUTCMonth()+1)},M:function(l){return c(l.getUTCMinutes())},p:function(l){return(l.getUTCHours()<12)?"AM":"PM"},P:function(l){return(l.getUTCHours()<12)?"am":"pm"},s:function(l){return c(l.getTime()/1000)},S:function(l){return c(l.getUTCSeconds())},w:function(l){return c(l.getUTCDay())},y:function(l){return c(l.getUTCFullYear()%100)},Y:function(l){return""+l.getUTCFullYear()},"%":function(l){return"%"}};g.date.strftime.parse_=function(r,t,q){var o=(q===true)?g.date.strftime.conversions_utc_:g.date.strftime.conversions_;var m="";var p=0;var n=r.length;while(p<n){if(r.charAt(p)==="%"){var u=r.charAt(p+1);if(g.date.strftime.conversions_[u]){m+=o[u](t)}else{m+=u}p++}else{var u=r.charAt(p);m+=u}p++}return m};g.date.digitalclock=function(l){this.options=e.extend({format:"%H:%M:%S",gmtOffset:null,timeout:1000,id:null},l?l:{});if(this.options.timeout<100){this.options.timeout=100}if(this.options.id){this.container=e("#"+this.options.id);if(this.container[0]){this.start()}}};g.date.digitalclock.clocks_=[];g.date.digitalclock.prototype.start=function(){var m=g.date.digitalclock.clocks_.push(this);var l=m-1;this.value="";this.tick();this.timer=window.setInterval("wui.date.digitalclock.clocks_["+l+"].tick()",this.options.timeout)};g.date.digitalclock.prototype.tick=function(){var l=new Date();if(this.options.gmtOffset!==null){var n=l.getTimezoneOffset()/60+parseFloat(this.options.gmtOffset);l.setMinutes(l.getMinutes()+n*60)}var m=g.date.strftime(this.options.format,l);if(m!=this.value){this.container.html(m);this.value=m}return this};g.date.digitalclock.prototype.stop=function(){this.timer=window.clearInterval(this.timer);return this};g.date.digitalclock.stop=function(){var m=g.date.digitalclock.clocks_;var l=m.length;while(--l>0){m[l].stop()}};g.date.millisecondsToUnit=function(l,m){var n=l;n/=1000;if(m==="second"){return n}n/=60;if(m==="minute"){return n}n/=60;if(m==="hour"){return n}n/=24;if(m==="day"){return n}if(m==="week"){return n/7}if(m==="month"){return n/30}if(m==="year"){return n/365}}})(wui,jQuery);(function(c,g){var e='<a href="/members/signup.asp" title="Create an account with wunderground">Join wunderground through Facebook</a>.',d="Facebook email not accessible.",f="Unable to sign in with Facebook.";c.member={};c.member.logged_in=function(){return jQuery("meta[name=wui-member-logged-in]").attr("content")==="true"};c.facebook={};c.facebook.initialized=false;c.facebook.load_handlers=[];c.facebook.app_id=g("meta[name=fb-app-id]").attr("content");c.facebook.channel_url=g("meta[name=fb-channel-url]").attr("content");c.facebook.permissions={scope:"email"};c.facebook.on_load=function(j){if(c.facebook.initialized){j.apply()}else{c.facebook.load_handlers.push(j)}};c.facebook.on_load_trigger=function(){FB.getLoginStatus(function(j){c.facebook.initialized=true;h(j.status);g.each(c.facebook.load_handlers,function(k,l){l.apply()});c.facebook.load_handlers=[]})};c.facebook.wui_login=function(j){return g.post("/php/c/user_session/create.php",{signed_request:FB.getAuthResponse().signedRequest}).error(function(k){var l=g.parseJSON(k.responseText).error_code,m=f;if(l==="pending_payment"){document.location.href="http://payment.wunderground.com/NoAdsPayment.php?mode=noads&return="}if(j){if(l==="email_missing"){m=d;c.facebook.revoke_permissions()}else{if(l==="email_mismatch"){m=e}}j({code:l,message:m})}})};c.facebook.login=function(j){return FB.login(j,c.facebook.permissions)};c.facebook.revoke_permissions=function(j){return FB.api("me/permissions","DELETE",{},function(k){setTimeout(function(){FB.getLoginStatus(function(l){},true)},1);if(jQuery.isFunction(j)){j.apply()}})};var b="unknown";c.facebook.status=function(){return b};c.facebook.is_status_unknown=function(){return c.facebook.status()=="unknown"};c.facebook.is_status_connected=function(){return c.facebook.status()=="connected"};c.facebook.is_status_not_connected=function(){return c.facebook.status()=="not_authorized"};var h=function(k){b=k;var j={connected:"fb-connected",not_authorized:"fb-not-connected",unknown:"fb-unknown"},l=j[k]||j.unknown;g.each(j,function(m,n){if(l!=n){g("body").removeClass(n)}});g("body").addClass(l)};c.facebook.on_load(function(){FB.Event.subscribe("auth.authResponseChange",function(j){h(j.status)})});var a=function(j){if(c.member.logged_in()){g.post("/php/c/facebook_connection/create.php",{fb_uid:j.authResponse.userID})}};c.facebook.on_load(function(){FB.Event.subscribe("auth.login",a)});c.facebook.logout=function(j){FB.logout(j)};c.facebook.is_member=function(j,k){if(k){return g.get("/php/c/member/get.php",{signed_request:j.signedRequest}).success(function(l){k(l.email)}).error(function(){k(null)})}}})(wui,jQuery);(function(b,d){var c={activeClass:"active",disabledClass:"disabled",items:".fav-item",scroll:{},sortable:{},home:{}};b.favorites={};b.favorites.add=function(e,f){b.favorites._modify(e,"addfavorite",null,f)};b.favorites.del=function(e,f){b.favorites._modify(e,"delfavorite",null,f)};b.favorites.toggle=function(e,f){var h=d(f).hasClass(c.activeClass);var g=(h)?"delfavorite":"addfavorite";b.favorites._modify(e,g,f)};b.favorites._modify=function(e,j,g,h){var f="/favorites/submit.html?"+d.param(d.extend({action:j,place:e,conditions:false},h));if(document.domain.indexOf(".wunderground.com")<0){f="//www.wunderground.com"+f}var g=d(g);d(this).triggerHandler("beforechange",[e,j]);d.ajax({url:f,type:"get",dataType:"jsonp",jsonp:"jsonp",success:function(l){var n="Error";var k=l.RESULTS||l;if(k.indexOf(n.toLowerCase())>=0){alert(k)}else{if(g[0]){var m=g.hasClass(c.activeClass);if(m){g.removeClass(c.activeClass)}else{g.addClass(c.activeClass)}}}if(l.location){b.favorites.items.add(l.location)}d(b.favorites).triggerHandler("change",[e,j,l.location])},error:function(k){alert("Error: wui.favorites ajax request failed")}})};b.favorites._getActiveIndex=function(){var f=d(c.items);for(var e=0;e<f.length;e++){if(f.eq(e).hasClass(c.activeClass)){return e}}return -1};b.favorites.next=function(){var e=b.favorites._getActiveIndex();b.favorites.go(e+1)};b.favorites.prev=function(){var e=b.favorites._getActiveIndex();b.favorites.go(e-1)};b.favorites.go=function(e){var g=d(c.items);if(e<0){e=g.length-1}if(e>=g.length){e=0}var f=g.eq(e);if(f[0]){window.location=f.attr("href")}};b.favorites.is=function(e){if(b.page&&b.page.collections.favorites){return b.page.collections.favorites.hasZMW(e)}if(b.favorites.list){return b.favorites.items.is(e)}throw ("Error: Cannot determine if location is a favorite.")};b.favorites.scroll={};b.favorites.scroll.left=function(){b.favorites.scroll.calculateIndex();if(c.scroll.index>0){b.favorites.scroll.go(c.scroll.index-3)}};b.favorites.scroll.right=function(){b.favorites.scroll.calculateIndex();var e=c.scroll.items;if(c.scroll.index<e.length-1){b.favorites.scroll.go(c.scroll.index+3)}};b.favorites.scroll.snap=function(){b.favorites.scroll.calculateIndex();b.favorites.scroll.go(c.scroll.index)};b.favorites.scroll.go=function(e){if(e<0){e=0}else{if(e>c.scroll.items.length-1){e=c.scroll.items.length-1}}var f=c.scroll.items.eq(e);if(!f.is(":visible")){c.scroll.index++;b.favorites.scroll.go(c.scroll.index);return}var g=f.position().left+c.scroll.container.scrollLeft();c.scroll.container.animate({scrollLeft:g},{duration:"slow",complete:function(){b.favorites.scroll.setButtons()}})};b.favorites.scroll.calculateIndex=function(){var e=c.scroll.items;for(var f=0;f<e.length;f++){if(e.eq(f).position().left+e.eq(f).width()/2>=0){c.scroll.index=f;break}}};b.favorites.scroll.setButtons=function(){var e=c.scroll.items;var g=e.eq(0);var f=e.eq(-1);if(!g[0]||g.position().left>=0){c.scroll.leftButton.addClass(c.disabledClass)}else{c.scroll.leftButton.removeClass(c.disabledClass)}if(!f[0]||f.position().left+f.width()<=c.scroll.container.width()){c.scroll.rightButton.addClass(c.disabledClass)}else{c.scroll.rightButton.removeClass(c.disabledClass)}};b.favorites.scroll.initialize=function(){c.scroll={index:0,bar:d("#favoritesBar"),container:d("#favoritesBar .favoritesScrollContainer"),items:d("#favoritesBar .favoritesItem"),leftButton:d("#favoritesBar .favoritesScrollLeft"),rightButton:d("#favoritesBar .favoritesScrollRight"),allButtons:d("#favoritesBar .favoritesScrollButtons"),title:d("#favoritesBar .favoritesTitle")};if(d.browser.msie&&parseInt(d.browser.version.charAt(0))<7){var g=829;var j=c.scroll.title.outerWidth();var h=c.scroll.allButtons.outerWidth();var f=g-j-h;c.scroll.container.width(f)}b.favorites.scroll.setButtons();var e=c.scroll.container;e.mousedown(function(k){d(this).data("down",true).data("x",k.clientX).data("scrollLeft",this.scrollLeft);d(window).bind("mousemove.favorites",function(l){if(e.data("down")==true){e[0].scrollLeft=e.data("scrollLeft")+e.data("x")-l.clientX}});if(k.which===1){k.preventDefault()}d(window).one("mouseup.favorites",function(l){d(window).unbind("mousemove.favorites");if(e.data("down")==true){b.favorites.scroll.snap();b.favorites.scroll.setButtons()}e.data("down",false)})}).click(function(k){if(e.data("scrollLeft")!=e[0].scrollLeft){k.preventDefault()}})};b.favorites.scroll.load=function(f,j){var g=decodeURIComponent(f);var o=g.split(",");var l=j;if(l=="//"){l="/a/"}if(h(o)){var e="<div class='noFavs'>You don't appear to have any favorites yet, or your cookies may be disabled.</div>";d(".loadFavs").css("display","none");d(".favoritesScroll").css("display","none");d(".favoritesScrollContainer").append(e);return}d(".favoritesScrollButtons").css("visibility","hidden");var n=[];var k=[];d.each(o,function(v,r){if(r==""){return}var x=m(r);var p="//api.wxug.com/api/ea5c64c3975ff6cd/conditions/alerts/q/";var q=".json?ttl=6000";var u=p+x+q;var t="cityFav"+v;var w=_.template(d("#cellTemplate").html(),{zmw:x,cityFavNum:t});d("#favoritesRow").append(w);k[x]={};n.push(d.ajax({url:u,dataType:"jsonp",timeout:10000,success:function(F,M){d(".loadFavs").css("display","none");d(".favoritesScroll").css("display","");var B=d("#"+t);var I=F.current_observation;if(I==undefined){B.remove();return}var E=I.temp_f,H=I.icon_url,L=I.weather,y=I.forecast_url,G=I.weather,K=I.display_location["latitude"],A=I.display_location["longitude"],z=I.icon,D=I.temperature_string;var C=H.replace("/k/",l);var J;if(I.display_location["zip"]=="00000"){J=I.display_location["city"]+", "+I.display_location["country"]}else{J=I.display_location["full"]}var N=F.alerts.length!==0;B.find(".favCity").html(J);B.find(".favTemp .b").html(E);B.find(".favTemp .nobr").append("&#176;F");B.find(".condIcon").attr("alt",G);B.find(".condIcon").attr("title",G);B.find(".condIcon").attr("src",C);B.find(".condIcon").css("display","");B.css("display","");k[x]={name:J,type:"favorite",lat:K,lon:A,zmw:x,condition:{temp:D,icon:z,iconPref:l[1],weather:G}};if(N){B.addClass("warnBG");B.find(".warnIcon").css("display","");if(v>=5){d(".favoritesScrollRight").addClass("orange")}}if(v>=5){d(".favoritesScrollRight").removeClass("disabled")}}}))});d.when.apply(d,n).then(function(){b.favorites.scroll.initialize();d(".favoritesScrollButtons").css("visibility","visible");var q=[];for(var r in k){q.push(k[r])}b.favorites.items.add(q);if(b&&b.autocomplete){var p=new b.autocomplete({appendTo:"#wuFormR",autosubmit:true,data:{ski:1,features:1},includeFavorites:true,includePWS:true,input:"#wuSearchR",minLength:0,showConditions:true,showFavoriteStars:true})}d("#wuSubmitR").click(function(){d("#wuFormR").submit()})});function m(v){var p=v.split(".");var r,u,q;if(p.length==3){r=p[0];u=p[1];q=p[2]}else{if(p[0]=="00000"){r="00000";u="1";q=p[1]}else{r=p[0];u=p[1];q="99999"}}var t=r+"."+u+"."+q;return t}function h(p){for(var q=0;q<p.length;q++){if(p[q]!=""){return false}}return true}};b.favorites.sortable={};b.favorites.sortable.initialize=function(){c.sortable={dragClass:"favMove",draggableClass:"favCursorMove",loadingClass:"ajax-loading",deleteButtonClass:"deleteButton",index:0,list:d("#favorites-list"),items:d("#favorites-list li"),log:d("#log")};c.sortable.list.sortable({axis:"y",containment:c.sortable.list,distance:3,tolerance:"pointer",start:function(e,f){f.item.addClass(c.sortable.dragClass)},stop:function(e,f){f.item.removeClass(c.sortable.dragClass)},update:function(e,f){b.favorites.sortable.submit()}});c.sortable.items.each(function(e,f){b.favorites.sortable.setupItem(d(f))})};b.favorites.sortable.createItem=function(g,e){var f=d("<li></li>").attr("id",g).html(e);f.hide();f.appendTo(c.sortable.list);b.favorites.sortable.setupItem(f);f.fadeIn(2000);return f};b.favorites.sortable.setupItem=function(f){f.addClass(c.sortable.draggableClass);var e=d("<span></span>").addClass(c.sortable.deleteButtonClass);e.click(function(){d(f).remove();b.favorites.sortable.refresh();b.favorites.sortable.submit()});f.append(e)};b.favorites.sortable.refresh=function(){c.sortable.list.sortable("refresh")};b.favorites.sortable.submit=function(){var e="/favorites/submit.html";var f=","+c.sortable.list.sortable("toArray").join(",");b.favorites.sortable.setLoading(true,null,0);d.ajax({url:e,type:"post",data:{action:"reorderfavorites",order:f},dataType:"html",success:function(g){b.favorites.sortable.setLoading(false,g,3000)},error:function(g){var h="Error: wui.favorites.sortable ajax request failed";b.favorites.sortable.setLoading(false,h,0)}})};b.favorites.sortable.setLoading=function(g,h,e){var f=c.sortable.log;if(g==true){f.empty().addClass(c.sortable.loadingClass)}else{f.empty().removeClass(c.sortable.loadingClass)}if(h){f.html(h)}if(e){window.setTimeout(function(){f.empty()},e)}};b.favorites.home=function(e,g,f){c.home={activeClass:"active",inactiveClass:""};b.favorites.home._modify(e,g,f)};b.favorites.home.toggle=function(e,h,g,k,f){if(g||g===""){c.home.activeClass=g}if(k||k===""){c.home.inactiveClass=k}var j=d(h).hasClass(c.home.activeClass);if(j){e=""}if(j){f=""}b.favorites.home._modify(e,h,f)};b.favorites.home._modify=function(e,g,f){var g=d(g);d.ajax({url:"/auto/wui/geo/PrefDump/index.html?setprefs.0.key=USERHOME&setprefs.0.val="+e+"&setprefs.1.key=USERHOMENAME&setprefs.1.val="+f,type:"get",dataType:"html",success:function(h){if(g){if(g.hasClass(c.home.activeClass)==true){g.removeClass(c.home.activeClass).addClass(c.home.inactiveClass)}else{g.addClass(c.home.activeClass).removeClass(c.home.inactiveClass)}}},error:function(h){alert("Error: wui.favorites.home ajax request failed")}})};b.favorites.items={_list:[],add:function(e){if(d.isArray(e)){this._list=this._list.concat(e)}else{this._list.push(e)}},remove:function(f,g){var e=this.indexOf(f,g);if(e>-1){this._list.splice(e,1)}},empty:function(){this._list=[]},find:function(f,g){var e=this.indexOf(f,g);if(e>-1){return this._list[e]}else{return null}},getList:function(){return this._list},indexOf:function(e,g){var f=this.indicesOf(e,g);if(f.length){return f[0]}else{return -1}},indicesOf:function(e,g){var f=d.map(this._list,function(j,h){if(!j){return null}else{if(j[e]===g){return h}else{return null}}});return f},is:function(f){var e=this.indexOf("zmw",f);return(e>-1)}};var a={options:{eventName:"click",classNames:{selected:"active",star:"favorite-star"}},check:function(g){var f=a.options;var h=g.attr("data-zmw");var e=b.page.collections.favorites.hasZMW(h);g.toggleClass(f.classNames.selected,!!e)},disable:function(g){var f=a.options;if(!g){g=d(document)}var e="."+f.classNames.star;g.off(f.eventName,e,a.onClick)},enable:function(g){var f=a.options;if(!g){g=d(document)}var e="."+f.classNames.star;g.on(f.eventName,e,a.onClick)},initialize:function(f){a.options=d.extend(true,a.options,f);a.scan();a.disable();a.enable();var e=b.page.collections.favorites;e.on("add remove",function(){a.scan()},a)},onClick:function(){var g=a.options;var k=g.classNames;var h=d(this);var j=h.attr("data-zmw");var e=b.page.collections.favorites;var f=e.hasZMW(j);if(f){h.removeClass(k.selected);e.delFavorite(j)}else{h.addClass(k.selected);e.addFavorite(j)}},scan:function(g){var f=a.options;if(!g){g=d(document)}var e="."+f.classNames.star;g.find(e).each(function(){var h=d(this);a.check(h)})}};b.favorites.stars=a})(wui,jQuery);(function(a,b){a.tooltip=function(c){this.options=b.extend(true,{button:null,position:{my:"center bottom",at:"center top",of:null,offset:"0 -14",collision:"none none"},arrow_position:null,content:null,delayShow:100,delayHide:100,id:null,nohoverClass:"tooltip br3 bs005x333",hoverClass:null,closeButton:false,closeButtonText:"",closeButtonClass:"closeButton",allowTouch:false},c?c:{});this.options.position.of=this.options.button||this.options.position.of;this.initialized=false;this.visible=false;this.container=null;this.contentArea=null;this.arrow=null;this.enable()};a.tooltip.prototype.initialize=function(){this.container=b("<div></div>");this.container.css({position:"absolute",top:0,left:0});this.container.addClass(this.options.nohoverClass);if(this.options.id){this.container.attr("id",this.options.id)}if(this.options.closeButton==true){var c=this;this.closeButton=b('<a href="javascript:void(0);">'+this.options.closeButtonText+"</a>");this.closeButton.addClass(this.options.closeButtonClass).appendTo(this.container);this.closeButton.click(function(f){c.hide()})}this.contentArea=b("<div>Loading&hellip;</div>").appendTo(this.container);this.arrow=b("<div></div>").addClass("ttPoint").appendTo(this.container);this.arrow.css({position:"absolute",top:0,left:0});this.container.hide();this.container.appendTo(document.body);var d=b(this.options.button);this.container.mouseenter(function(f){d.stop(true)}).mouseleave(function(f){d.mouseleave()});this.initialized=true};a.tooltip.prototype.enable=function(){var c=this;var e=b(this.options.button);var d=this.options;if(c.options.allowTouch==true){e.bind("touchstart.tooltip",function(g){if(c.visible){c.hide()}else{e.unbind("mouseenter.tooltip");e.unbind("mouseleave.tooltip");c.show();if(b.isFunction(d.content)){var f=d.content(c);if(f){c.write(f)}}else{if(d.content!==null){c.write(d.content)}}c.position()}})}e.bind("mouseenter.tooltip",function(f){if(c.visible){return}c.visible=true;e.stop(true).delay(d.delayShow).queue(function(h){c.show();if(b.isFunction(d.content)){var g=d.content(c);if(g){c.write(g)}}else{if(d.content!==null){c.write(d.content)}}c.position();h()})});e.bind("mouseleave.tooltip",function(f){e.stop(true).delay(d.delayHide).queue(function(g){if(c.container){c.hide();c.container.removeClass(d.hoverClass)}c.visible=false});e.removeClass(d.hoverClass)})};a.tooltip.prototype.disable=function(){var c=b(this.options.button);c.unbind("mouseenter.tooltip");c.unbind("mouseleave.tooltip")};a.tooltip.prototype.position=function(){this.container.position(this.options.position);var c=b.extend(true,{},this.options.position,{offset:"0 0",collision:"none none"});if(this.options.arrow_position){c=b.extend(true,{},c,this.options.arrow_position)}this.arrow.position(c);this.arrow.css({top:""})};a.tooltip.prototype.remove=function(){this.disable();if(this.container){this.container.remove()}this.initialized=false;this.visible=false};a.tooltip.prototype.write=function(c){this.contentArea.empty().append(c)};a.tooltip.prototype.getContainer=function(){return this.container};a.tooltip.prototype.hide=function(){if(this.container){this.container.hide();this.container.removeClass(this.options.hoverClass)}this.visible=false;b(this.options.button).removeClass(this.options.hoverClass);b("body").off("touchstart.tooltip.document")};a.tooltip.prototype.show=function(){if(!this.initialized){this.initialize()}this.visible=true;this.container.show();b(this.options.button).addClass(this.options.hoverClass);this.container.addClass(this.options.hoverClass);var c=this;c.container.bind("touchstart.tooltip",function(d){c.hide()})}})(wui,jQuery);(function(a,d){var b={};var c=[];a.glossary={};a.glossary.initialize=function(e){b=d.extend({selector:"dfn",url:"/glossary/responder.html",cache:{},tooltip:{delayShow:300,delayHide:300,hoverClass:null,position:{collision:"fit none"}}},e?e:{});this.start()};a.glossary.start=function(){d(b.selector).each(function(e){a.glossary.add(this)})};a.glossary.stop=function(){while(c.length>0){var e=c.pop();e.remove()}};a.glossary.add=function(g){var e=d(g);var f=b.tooltip;f.button=e;f.content=function(l){var k=e.attr("data-term");if(!k){k=e.text()}var j=e.attr("data-definition");a.glossary.lookup(k,l,j)};var h=new a.tooltip(f);c.push(h)};a.glossary.lookup=function(f,g,e){if(e){g.write(e);g.position()}else{if(b.cache[f]){g.write(b.cache[f]);g.position()}else{d.ajax({url:b.url,dataType:"html",data:{term:f},success:function(h,j){b.cache[f]=h;g.write(h);g.position()}})}}}})(wui,jQuery);(function(a,b){a.HorizontalMenu=function(c){this.initialize(c)};a.HorizontalMenu.prototype.initialize=function(c){var d=this;this.options=b.extend(true,{selectors:{menu:"> ul",menu_item:"li",right_matter:"",more_menu_only:".more-menu-only"},tags:{menu:"ul",menu_item:"li"},more_label_width:75,more_label_text:"More",active_menu_class:"menu-active",hidden_menu_class:"hide",more_menu_sibling_key:"more-menu-sibling",menu_data_key:"menu"},c);this.$container=this.options.menu;this.$menu=this.$container.find(this.options.selectors.menu);this.$right_matter=this.$container.find(this.options.selectors.right_matter);this.$menu_labels=this.$menu.children(this.options.selectors.menu_item);this.$submenus=this.$menu_labels.map(function(){return b(this).data(d.options.menu_data_key)});this.$more_menu_label=b("<"+this.options.tags.menu_item+">",{"class":"more-menu-label"}).append(b("<label>",{"class":"more",text:this.options.more_label_text}));this.$menu.append(this.$more_menu_label);this.$more_menu=this.createMoreMenu(this.$menu_labels);this.$more_menu.appendTo(this.$container);this.$more_menu_items=this.$more_menu.find(this.options.tags.menu_item);this.$more_menu_label.data(this.options.menu_data_key,this.$more_menu.get(0));this.$menu_labels.remove(this.options.selectors.more_menu_only);this.$menu_labels=this.$menu_labels.not(this.options.selectors.more_menu_only);this.$more_menu_submenu_labels=this.$more_menu_items.filter(function(){return b(this).data(d.options.menu_data_key)});this.$more_menu_submenus=this.$more_menu_submenu_labels.map(function(){return b(this).data(d.options.menu_data_key)});this.addEvents();this.updateMenu()};a.HorizontalMenu.prototype.createMoreMenu=function(e){var j=this,f=this.options.more_menu_sibling_key,d=b("<div>",{"class":"menu-wrapper more-menu"}),h={},g=b("<"+this.options.tags.menu+">",{"class":"menu-list primary-menu"});d.append(g);h=e.map(function(){var k=b(this).clone(true);b(this).data(f,k);return k[0]});var c=h.map(function(){var k=b(this).data(j.options.menu_data_key);if(k){var l=b(k).clone();b(this).data(j.options.menu_data_key,l.get(0));return l.get(0)}});d.append(c);h.appendTo(g);return d};a.HorizontalMenu.prototype.addEvents=function(){var d=this,c=b.proxy(this.updateMenu,this);b(window).on("resize orientationchange",c);b(document).click(function(){d.hideMenus()});this.$menu_labels.add(this.$more_menu_label).each(function(){var e={$label:b(this),$submenus:d.$submenus.add(d.$more_menu),$menu_labels:d.$menu_labels.add(d.$more_menu_label)};b(this).click(e,b.proxy(d.toggleMenu,d))});this.$more_menu_items.each(function(){var e={$label:b(this),$submenus:d.$more_menu_submenus,$menu_labels:d.$more_menu_items};b(this).click(e,b.proxy(d.toggleMenu,d))})};a.HorizontalMenu.prototype.toggleMenu=function(d){var g=d.data.$label,f=b(g.data(this.options.menu_data_key)),e=d.data.$submenus,c=d.data.$menu_labels;if(f&&f[0]){d.stopPropagation();e.not(f).removeClass(this.options.active_menu_class);c.not(g).removeClass(this.options.active_menu_class);g.add(f).toggleClass(this.options.active_menu_class)}};a.HorizontalMenu.prototype.showTopMostMoreMenuSubnav=function(){var c=this.$more_menu_submenu_labels.not(".hidden").first();if(c[0]){this.showMoreMenuSubnav(c)}};a.HorizontalMenu.prototype.showMoreMenuSubnav=function(e){var d=e.data(this.options.menu_data_key),c=this.$more_menu_submenus;this.$more_menu_items.not(e).removeClass(this.options.active_menu_class);c.not(d).removeClass(this.options.active_menu_class);e.add(d).addClass(this.options.active_menu_class)};a.HorizontalMenu.prototype.hideMenus=function(){this.$menu_labels.add(this.$more_menu_label).removeClass(this.options.active_menu_class);this.$submenus.add(this.$more_menu).removeClass(this.options.active_menu_class);this.$more_menu_submenus.removeClass(this.options.active_menu_class)};a.HorizontalMenu.prototype.updateMenu=function(){var c=this;this.$menu.css("padding-right",this.paddingRight()+"px");this.hideMenus();this.positionMoreMenu();this.$menu_labels.add(this.$more_menu_label).each(function(){c.positionSubmenu(b(this))});this.updateMoreMenuContents();this.showTopMostMoreMenuSubnav()};a.HorizontalMenu.prototype.positionMoreMenu=function(){var d=0,c=this.$visibleMenuLabels();this.$more_menu_label.toggleClass(this.options.hidden_menu_class,this.$menu_labels.not(c).size()==0);c.each(function(){d+=b(this).outerWidth(true)});this.$more_menu_label.css("left",d+"px");this.$more_menu.css("left",d+"px")};a.HorizontalMenu.prototype.updateMoreMenuContents=function(){var d=this.options;this.$more_menu_items.removeClass(d.hidden_menu_class);var c=this.$visibleMenuLabels();c.each(function(){b(this).data(d.more_menu_sibling_key).addClass(d.hidden_menu_class)});if(this.$menu_labels.length!==0){this.$more_menu_label.removeClass("hide");if(this.$menu_labels.length===c.length){this.$more_menu_label.addClass("hide")}}};a.HorizontalMenu.prototype.positionSubmenu=function(d){var c=b(d.data(this.options.menu_data_key));c.css("left",d.position().left+"px");c.css("top",d.outerHeight()+"px")};a.HorizontalMenu.prototype.$visibleMenuLabels=function(){return this.$menu_labels.filter(function(){return b(this).position().top==0})};a.HorizontalMenu.prototype.paddingRight=function(){var c=this.options.more_label_width;if(this.$right_matter[0]){c+=this.$right_matter.outerWidth(true)}return c}})(wui,jQuery);(function(a,b){a.Menu=function(c){this.initialize(c)};a.Menu.prototype.initialize=function(c){this.options=b.extend(true,{classNames:{selected:"selected"},duration:400,selectors:{container:null,goBack:".sideGoBack",gotMore:".gotMore",subMenu:".sideSubNav"}},c);this.level=0;this.$selected=null;this.$container=b(this.options.selectors.container);this.addEvents()};a.Menu.prototype.addEvents=function(){var c=this;this.$container.bind("click",function(g){var d=b(g.target),e=d.closest("li"),f=e.hasClass(c.options.classNames.selected);if(e.is(c.options.selectors.gotMore)&&!f){g.preventDefault();g.stopPropagation();c.deselectAll();c.select(e);c.setLevel(c.level+1)}if(e.is(c.options.selectors.goBack)){g.preventDefault();g.stopPropagation();var h=c.setLevel(c.level-1);h.done(function(){c.deselectAll();c.back(e)})}})};a.Menu.prototype.select=function(c){$parents=c.parentsUntil(this.$container,this.options.selectors.gotMore);$parents.addClass(this.options.classNames.selected);c.addClass(this.options.classNames.selected);this.$selected=c};a.Menu.prototype.deselectAll=function(){var c=this.$container.find(this.options.selectors.gotMore);c.removeClass(this.options.classNames.selected);this.$selected=null};a.Menu.prototype.back=function(c){$parents=c.parentsUntil(this.$container,this.options.selectors.gotMore);c=$parents.eq(1);if(c[0]){this.select(c)}};a.Menu.prototype.getLevel=function(){return this.level};a.Menu.prototype.setLevel=function(e){e=Math.max(0,e);this.level=e;var c=e*-100;var d=this.slideTo(c);return d};a.Menu.prototype.slideTo=function(c){this.$container.animate({left:""+c+"%"},this.options.duration);return this.$container.promise()}})(wui,jQuery);(function(b,c){var a={};var d={classNames:{selected:"active"},eventName:"click.sidebar",selectors:{toggles:"#sidebarButton, .active #sidebar-gutter, .active #mobile-header"}};b.sidebar={initialize:function(e){a=c.extend(true,{},d,a,e);b.sidebar.addEvents()},addEvents:function(){c(document).on(a.eventName,a.selectors.toggles,function(f){f.preventDefault();f.stopPropagation();b.sidebar.toggle()})},show:function(){c("body").addClass(a.classNames.selected)},hide:function(){c("body").removeClass(a.classNames.selected)},toggle:function(){c("body").toggleClass(a.classNames.selected)}}})(wui,jQuery);(function(e,f,h){var c="modal";var a=null;var g={classNames:{closeButton:"modal-close",modal:"modal",open:"open",overlay:"modal-overlay",selected:"selected"},close_on_esc:true,close_on_overlay_click:true,eventname:"click",hide:{duration:1000},show:{duration:1000}};var b=function(j){this.initialize(j)};b.prototype.initialize=function(j){this.options={delegatedTrigger:null,modal:null,trigger:null};this.setOptions(j);this.numOpens=0;this.$modal=f(this.options.modal);this.$trigger=f(this.options.trigger);this.addEvents()};b.prototype.setOptions=function(j){this.options=f.extend(true,{},g,this.options,j)};b.prototype.addEvents=function(){var j=this;if(this.options.delegatedTrigger){f(document).on(this.options.eventname,this.options.delegatedTrigger,function(){j.open()})}else{this.$trigger.on(this.options.eventname+"."+c,function(){j.open()})}};b.prototype.addCloseEvents=function(){var j=this;if(this.options.close_on_overlay_click){a.on(this.options.eventname+"."+c,function(){j.close()})}var k=this.$modal.find("."+this.options.classNames.closeButton);k.on(this.options.eventname+"."+c,function(){j.close()});if(this.options.close_on_esc){f(document).on("keyup."+c,function(l){if(l.which===27){j.close()}})}};b.prototype.checkCreateOverlay=function(){if(!a){a=d()}};b.prototype.open=function(){f(this).triggerHandler("beforeopen");this.numOpens+=1;this.checkCreateOverlay();this.addCloseEvents();if(this.numOpens<=1){this.$modal.insertAfter(a)}a.addClass(this.options.classNames.open);a.show();this.$modal.addClass(this.options.classNames.open);if(this.options.show){this.$modal.show(this.options.show)}f(this).triggerHandler("open")};b.prototype.close=function(){var j=f(this).triggerHandler("beforeclose");if(j===false){return}this.$modal.removeClass(this.options.classNames.open);if(this.options.hide){this.$modal.hide(this.options.hide)}a.removeClass(this.options.classNames.open);a.hide();f(this).triggerHandler("close")};function d(){var j=f("<div />").addClass(g.classNames.overlay).appendTo(f("body"));return j}e.Modal=b})(wui,jQuery);(function(n,h){var e={};var p=0;var a=null;var o=0;var r=0;var b=0;var c=null;var l=null;var d=null;var k=null;var j=null;var m=null;var f=false;var q=true;var g=[];n.stationselector=function(t){e=h.extend({lat:0,lon:0,zoom:10,draggable:true,selector:null,mapSelector:null,showhideSelector:null,showhideSecondarySelector:null,rowPWSSelector:null,rowAirportSelector:null,conditionsSelector:null,forecastSelector:null,numstartSelector:null,numendSelector:null,numtotalSelector:null,nextSelector:null,prevSelector:null,timelabelSelector:null,webcampreviewSelector:null,webcamiconSelector:null,webcamShowDelay:500,webcamHideDelay:100,condsboxurl:null,zmw_key:null,max:100,fitBounds:false,markerPWSClass:"",markerAirportClass:"",selectedClass:"selected",hoverClass:"hover",expandedClass:"expanded",disabledClass:"disabled",renumbering:true,onSelect:null},t?t:{});var u=[];if(e.showhideSelector){u.push(e.showhideSelector)}if(e.showhideSecondarySelector){u.push(e.showhideSecondarySelector)}var v=h(u.join(","));v.live("click",function(w){var x=h(e.selector).is(":visible");if(x){n.stationselector.hide()}else{n.stationselector.show()}})};n.stationselector.show=function(){h(e.selector).show().removeClass("none");if(e.selector){h(e.selector).position({my:"right top",at:"right bottom",of:e.showhideSelector,collision:"none none",offset:"14 12"})}h(e.showhideSelector).addClass(e.expandedClass);n.stationselector.load()};n.stationselector.hide=function(){h(e.selector).hide().addClass("none");h(e.showhideSelector).removeClass(e.expandedClass);n.stationselector.webcam.hide()};n.stationselector.load=function(){if(p!=1){if(window.google&&window.google.maps){p=1;n.stationselector.initialize()}}if(p!=1){var u="wui.stationselector.initialize";var t="http://maps.google.com/maps/api/js?libraries=geometry&client=gme-weatherunderground&channel=stationselector&sensor=false";if(u){t+="&callback="+u}h.getScript(t,function(v,w){p=1})}};n.stationselector.initialize=function(){var u={center:new google.maps.LatLng(e.lat,e.lon),draggable:e.draggable,mapTypeId:google.maps.MapTypeId.TERRAIN,mapTypeControl:false,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:true,scaleControl:false,scrollwheel:false,streetViewControl:false,zoom:e.zoom};var t=h(e.mapSelector);a=new google.maps.Map(t[0],u);n.stationselector.defineClasses();j=h(e.rowAirportSelector);m=h(e.rowPWSSelector);j.each(function(v,w){n.stationselector.setupMarker(v,w,true)});m.each(function(v,w){n.stationselector.setupMarker(v,w,false)});google.maps.event.addListenerOnce(a,"tilesloaded",function(){for(var v=g.length-1;v>=0;v--){g[v].marker.setMap(a)}});r=m.length;b=r;n.stationselector.setVisibilites();h(e.nextSelector).click(function(v){n.stationselector.next();return false});h(e.prevSelector).click(function(v){n.stationselector.prev();return false});h(e.webcampreviewSelector).bind({mouseenter:function(){window.clearTimeout(k)},mouseleave:function(){k=window.setTimeout(function(){n.stationselector.webcam.hide()},e.webcamHideDelay)}});google.maps.event.addListener(a,"idle",n.stationselector.mapChanged)};n.stationselector.setupMarker=function(x,E,A){E=h(E);var B=parseFloat(E.attr("data-lat"))||0;var t=parseFloat(E.attr("data-lon"))||0;var C=E.attr("title");var D=new google.maps.LatLng(B,t);var z=(x+1);var y=(A)?"":z;var v=A||(x>=o&&x<o+e.max);var w=new n.stationselector.HTMLOverlay({content:y,clickable:true,position:D,visible:v,title:C});if(A){w.addClass(e.markerAirportClass)}else{w.addClass(e.markerPWSClass)}if(E.hasClass(e.selectedClass)){c=E;l=w;w.addClass(e.selectedClass)}E.bind({mouseenter:function(){E.addClass(e.hoverClass);w.addClass(e.hoverClass)},mouseleave:function(){E.removeClass(e.hoverClass);w.removeClass(e.hoverClass)},click:function(F){F.preventDefault();n.stationselector.select(E,w,A)}});if(!v){E.addClass("none")}google.maps.event.addListener(w,"mouseover",function(){E.mouseenter()});google.maps.event.addListener(w,"mouseout",function(){E.mouseout()});google.maps.event.addListener(w,"click",function(){E.click()});g.push({row:E,marker:w,alwaysVisible:A,originalIndex:x,distance:0,in_bounds:false});var u=E.find(e.webcamiconSelector);u.bind({mouseenter:function(){u.addClass(e.hoverClass);d=window.setTimeout(function(){u.click()},e.webcamShowDelay)},mouseleave:function(){u.removeClass(e.hoverClass);window.clearTimeout(d);k=window.setTimeout(function(){n.stationselector.webcam.hide()},e.webcamHideDelay)},click:function(){return false}})};n.stationselector.select=function(x,t,v){if(!e.zmw_key){return}if(!x[0]){return}var y=x.attr("data-id");var w=new Date().getTime();n.stationselector.hide();var u="/auto/wui/geo/PrefDump/index.html?setprefs.0.key="+e.zmw_key+"&setprefs.0.val="+y;u+="&rand="+w;h.ajax({url:u,success:function(z,A){if(e.condsboxurl){h(e.conditionsSelector).fadeOut("slow");h.ajax({url:e.condsboxurl,dataType:"html",data:{rand:w,responder:"1",request:"conditions"},success:function(B,C){h(e.conditionsSelector).html(B);h(e.conditionsSelector).fadeIn("slow",function(){h(e.conditionsSelector).children().eq(0).unwrap()});h(e.forecastSelector).fadeOut("slow");h(e.timelabelSelector).html(h(e.timelabelSelector+"_hidden").html());h.ajax({url:e.condsboxurl,dataType:"html",data:{rand:w,responder:"1",request:"forecast"},success:function(D,E){h(e.forecastSelector).html(D);h(e.forecastSelector).fadeIn("slow",function(){})}})}})}c.removeClass(e.selectedClass);l.removeClass(e.selectedClass);x.addClass(e.selectedClass);t.addClass(e.selectedClass);c=x;l=t}});if(e.onSelect){e.onSelect.call(null,{id:y,isAirport:v})}};n.stationselector.setVisibilites=function(){var x=0;var G=0;var t=a.getBounds();var E=new google.maps.LatLngBounds();var F=j.length;if(F>0&&o==0){E.extend(g[0].marker.getPosition())}for(var A=0;A<g.length;A++){var D=g[A];if(D.alwaysVisible){continue}var H=D.row;var w=D.marker;var C=w.getPosition();if(f){var u=D.in_bounds;var v=(u&&x>=o&&G<o+e.max);if(u){G++}}else{var v=(x>=o&&x<o+e.max)}if(v){H.removeClass("none");w.setVisible(true);E.extend(C)}else{H.addClass("none");w.setVisible(false)}x++}if(e.fitBounds&&!f&&!E.isEmpty()){var z=new google.maps.LatLng(e.lat,e.lon);E.extend(z);a.fitBounds(E)}var B=r;var y=o+e.max;if(y>B){y=B}n.stationselector.updateCounters(o,y,B);if(f&&q){q=false}};n.stationselector.updateCounters=function(v,t,u){h(e.numstartSelector).html(v+1);h(e.numendSelector).html(t);h(e.numtotalSelector).html(u);if(v==0){h(e.prevSelector).addClass(e.disabledClass)}else{h(e.prevSelector).removeClass(e.disabledClass)}if(t>=u){h(e.nextSelector).addClass(e.disabledClass)}else{h(e.nextSelector).removeClass(e.disabledClass)}};n.stationselector.mapChanged=function(){if(h(a.getDiv()).width()<1||h(a.getDiv()).height()<1){q=true;return}if(q){q=false;return}f=true;var F=0;var t=a.getBounds();var u=a.getCenter();var E=j.length;var x=null;for(var A=0;A<g.length;A++){var D=g[A];var y=D.marker;var C=y.getPosition();D.in_bounds=(t.contains(C));if(D.in_bounds){D.distance=google.maps.geometry.spherical.computeDistanceBetween(u,C)}else{D.distance=Infinity}}g.sort(function(I,H){return I.distance-H.distance});for(var A=0;A<g.length;A++){var D=g[A];if(D.alwaysVisible){continue}var y=D.marker;var G=D.row;var C=y.getPosition();var v=D.in_bounds;var w=(v&&F<e.max);if(w){G.removeClass("none");y.setVisible(true);D.visible=true}else{G.addClass("none");y.setVisible(false);D.visible=false}if(v){F++;if(e.renumbering){y.setContent(F);G.find("span").eq(0).html(F);if(x){G.insertAfter(x)}x=G}}}o=0;r=F;var B=r;var z=o+e.max;if(z>B){z=B}n.stationselector.updateCounters(o,z,B)};n.stationselector.next=function(){if(o+e.max<r){o+=e.max;q=true;n.stationselector.setVisibilites()}};n.stationselector.prev=function(){if(o-e.max>=0){o-=e.max;q=true;n.stationselector.setVisibilites()}};n.stationselector.reset=function(){};n.stationselector.webcam=function(x,v){var y=h(e.webcampreviewSelector);var t=y.find("a");var u=y.find("img");var w=u.attr("src");t.attr("href",h(x).attr("href"));u.attr("src",v);y.removeClass("none");y.position({my:"center bottom",at:"center top",of:h(x)});if(w==v){n.stationselector.webcam.hide()}};n.stationselector.webcam.hide=function(){var u=h(e.webcampreviewSelector);var t=u.find("img");u.addClass("none");t.attr("src","")};n.stationselector.defineClasses=function(){n.stationselector.HTMLOverlay=function(t){this.options_=h.extend({position:null,content:null,map:null,mouseable:true,visible:true,title:"",pane:"mapPane",align:"center",valign:"center",offset:null},t?t:{});this.map_=this.options_.map;this.container_=h("<div></div>");this.mouseTarget_=null;this.width_=0;this.height_=0;this.setMap(this.map_)};n.stationselector.HTMLOverlay.prototype=new google.maps.OverlayView();n.stationselector.HTMLOverlay.prototype.onAdd=function(){this.container_.css({position:"absolute"});this.setContent(this.options_.content);var v=this.map_;var u=this.getPanes();if(this.options_.mouseable){u.overlayImage.appendChild(this.container_[0])}else{u[this.options_.pane].appendChild(this.container_[0])}this.width_=this.container_.width();this.height_=this.container_.height();if(this.options_.mouseable){this.mouseTarget_=h("<div></div>").css({position:"absolute",width:this.width_,height:this.height_,cursor:"pointer"});if(this.options_.title.length>0){this.mouseTarget_.attr("title",this.options_.title)}u.overlayMouseTarget.appendChild(this.mouseTarget_[0]);var t=this;this.mouseTarget_.bind({click:function(){google.maps.event.trigger(t,"click")},mouseenter:function(){google.maps.event.trigger(t,"mouseover")},mouseleave:function(){google.maps.event.trigger(t,"mouseout")}})}this.setVisible(this.options_.visible)};n.stationselector.HTMLOverlay.prototype.onRemove=function(){if(this.mouseTarget_){this.mouseTarget_.remove()}this.container_.remove()};n.stationselector.HTMLOverlay.prototype.draw=function(){var t=this.getProjection();var w=t.fromLatLngToDivPixel(this.options_.position);var v=w.x;var u=w.y;if(this.options_.align=="center"){v-=(this.width_/2)}else{if(this.options_.align=="right"){v-=(this.width_)}}if(this.options_.valign=="center"){u-=(this.height_/2)}else{if(this.options_.valign=="bottom"){u-=(this.height_)}}if(this.options_.offset){v+=this.options_.offset.x;u+=this.options_.offset.y}this.container_.css({left:v,top:u});if(this.mouseTarget_){this.mouseTarget_.css({left:v,top:u})}};n.stationselector.HTMLOverlay.prototype.setVisible=function(t){if(t){this.container_.show();if(this.mouseTarget_){this.mouseTarget_.show()}}else{this.container_.hide();if(this.mouseTarget_){this.mouseTarget_.hide()}}};n.stationselector.HTMLOverlay.prototype.setContent=function(t){this.container_.html(t)};n.stationselector.HTMLOverlay.prototype.getPosition=function(){return this.options_.position};n.stationselector.HTMLOverlay.prototype.addClass=function(t){this.container_.addClass(t)};n.stationselector.HTMLOverlay.prototype.removeClass=function(t){this.container_.removeClass(t)};n.stationselector.HTMLOverlay.prototype.toggleClass=function(t){this.container_.toggleClass(t)}}})(wui,jQuery);(function(b){var a=[];wui.ToolPanel=function(e){if(!e){return}this.options=b.extend({selectedClass:"selected",closeSelector:".ToolPanelClose",group_id:null,onShow:null,onHide:null,eventType:"click",position:null},e);this.options.group_id=e.group;this.elt_button=b(e.button);this.elt_panel=b(e.panel);this.elt_close=this.elt_panel.find(this.options.closeSelector);if(!wui.ToolPanel.groups){wui.ToolPanel.groups={}}if(this.options.group_id){var c=wui.ToolPanel.groups;if(!(this.options.group_id in c)){c[this.options.group_id]=[]}c[this.options.group_id].push(this)}a.push(this);var d=this;if(this.options.eventType=="hover"){this.elt_button.hover(function(f){if(f.type=="mouseenter"){d.show()}else{d.hide()}})}else{this.elt_button.click(function(){var f=d.elt_panel.is(":visible");if(f){d.hide()}else{d.show()}})}this.elt_close.click(function(){d.hide()});b(this).trigger("create")};wui.ToolPanel.prototype.show=function(){if(this.options.group_id){wui.ToolPanel.hideGroup(this.options.group_id)}this.elt_panel.removeClass("none").show();if(this.options.position){this.position(this.options.position)}if(this.options.selectedClass){this.elt_button.addClass(this.options.selectedClass)}if(this.options.onShow){this.options.onShow.call(this)}};wui.ToolPanel.prototype.hide=function(){this.elt_panel.removeClass("none").hide();if(this.options.selectedClass){this.elt_button.removeClass(this.options.selectedClass)}if(this.options.onHide){this.options.onHide.call(this)}};wui.ToolPanel.prototype.position=function(d){var c=b.extend({my:"left top",at:"left bottom",of:this.elt_button},d);this.elt_panel.position(c)};wui.ToolPanel.hideGroup=function(e){var c=wui.ToolPanel.groups;if(e in c){var f=c[e];for(var d=0;d<f.length;d++){f[d].hide()}}};wui.ToolPanel.hideAll=function(){var c=a;for(var d=0;d<c.length;d++){c[d].hide()}}})(jQuery);(function(b,c){var a={};var d={aup:null,iup:null,interval:120000,globalInterval:120000,enableAdRefresh:0,actionBased:false,globalIntervalTimer:null,globalTimeoutTimer:null,adsTimer:null};b.ads={initialize:function(e){a=c.extend(true,{},d,a,e);a.iup=c.now();if(a.actionBased){c(document).on("click keydown",function(){a.aup=c.now()})}},setDFPToNonMeta:function(){var e=b.bootstrapped.ads.ugc===true?["wund","ugc"]:"wund";googletag.pubads().clearTargeting("excl");googletag.pubads().setTargeting("excl",e);googletag.pubads().clearTargeting("mr")},setDFPToMeta:function(){var e=b.bootstrapped.ads.ugc===true?["wund","ugc","meta"]:["wund","meta"];googletag.pubads().clearTargeting("excl");googletag.pubads().setTargeting("excl",e);googletag.pubads().setTargeting("mr","1")},removeMetaRefresh:function(){var e=document.URL,h=e.split("?");if(h.length>=2&&e.indexOf("MR")!=-1){var k=encodeURIComponent("MR")+"=",g=h[1].split(/[&;]/g),f=null;for(f=g.length;f-->0;){if(g[f].lastIndexOf(k,0)!==-1){g.splice(f,1)}}e=h[0]+"?"+g.join("&");try{window.history.replaceState(null,null,e)}catch(j){return}}},refresh:function(){b.ads.setDFPToMeta();if(typeof index_headertag_lightspeed!=="undefined"){var e=(function(){var f=false;return function(){if(f){return}f=true;googletag.pubads().refresh()}}());index_headertag_lightspeed.add_session_end_hook(e,true);index_headertag_lightspeed.refresh()}else{googletag.pubads().refresh()}a.iup=c.now()},start:function(){if(a.interval&&a.enableAdRefresh==1){a.adsTimer=setInterval(function(){if(!_.isUndefined(window.googletag)&&!_.isNull(window.googletag)){if(a.actionBased){if(parseInt(a.aup)>=(parseInt(a.iup))){b.ads.refresh();if(a.globalTimeoutTimer!==null){clearInterval(a.globalTimeoutTimer);a.globalTimeoutTimer=null}if(a.globalIntervalTimer!==null){clearInterval(a.globalIntervalTimer);a.globalIntervalTimer=null}}else{if(0){if(a.globalTimeoutTimer===null){a.globalTimeoutTimer=setTimeout(function(){b.ads.refresh();if(a.globalIntervalTimer===null){a.globalIntervalTimer=setInterval(function(){b.ads.refresh()},a.globalInterval)}},(a.globalInterval-a.interval))}}}}else{b.ads.refresh()}}},a.interval)}else{}},stop:function(){clearInterval(a.adsTimer)},showTargetedAd:function(){if(!window.noAdBlocker&&!c("body").hasClass("paid")){var j=c("#targeted-banner");var e="";var l=b.bootstrapped.targetTag;var g=b.bootstrapped.targetId;var k="//www.amazon.com/gp/product/B00PSV10UK/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B00PSV10UK&linkCode=as2&tag="+l+"&linkId="+g;var h="//ir-na.amazon-adsystem.com/e/ir?t="+l+"&l=as2&o=1&a=B00PSV10UK";var f="//icons.wxug.com/i/o/weather-station-theme.png";if(b.bootstrapped.pageType=="CityPage"&&b.bootstrapped.citypage&&b.bootstrapped.citypage.defconLevel<3){k="//www.amazon.com/gp/search?ie=UTF8&camp=1789&creative=9325&index=industrial&keywords=emergency%20supplies&linkCode=ur2&tag=citypageemergencykit-20&linkId=7SCOK2CR7PCMNGPR";h="//ir-na.amazon-adsystem.com/e/ir?t=citypageemergencykit-20&l=ur2&o=1";f="//icons.wxug.com/i/o/severe-weather-theme.png"}e='<a target="_blank" href="'+k+'"><img src="'+f+'"></a><img src="'+h+'" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />';c("#top-ad-wrapper").attr("style","display: block !important;visibility:visible !important;");if(!c("#top-ad-wrapper").is(":visible")){c("#top-ad-wrapper").attr("id","top-x-wrapper")}j.html(e).removeClass("hide")}},showAmazonCreative:function(){if(typeof b.bootstrapped.ads.amazonTest!="undefined"){var j=c("#amazon-assc");var e="";var h=b.bootstrapped.ads.amazonTest.url;var g=b.bootstrapped.ads.amazonTest.beacon;var f=b.bootstrapped.ads.amazonTest.image;e='<a target="_blank" href="'+h+'"><img src="'+f+'" style="width: 100%; margin-bottom: 20px;"></a><img src="'+g+'" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />';j.html(e)}},showAdBlockerMessage:function(){if(!window.noAdBlocker&&!c("body").hasClass("paid")){var f=c(".blocker-banner");var e=f.data("src");var g=Math.floor(Math.random()*8)+1;c("#top-ad-wrapper").attr("style","display: block !important;visibility:visible !important;");if(!c("#top-ad-wrapper").is(":visible")){c("#top-ad-wrapper").attr("id","top-x-wrapper")}f.attr("src",e+"-"+g+".jpg");c(".ads-blocked").removeClass("hide")}}}})(wui,jQuery);if(!wui.usher){wui.usher={}}wui.usher.loadScript=function(e){var b=wui.bootstrapped.scripts[e];if(b.promise&&(b.promise.state()=="resolved"||b.promise.state()=="pending")){return b.promise}var a={async:false,cache:true,dataType:b.dataType||"script",url:b.url};if(b.timeout){a.timeout=b.timeout;a.async=true}var d=$.ajax(a);if(b.callback){var c=$.Deferred();b.promise=c}else{b.promise=d}if(b.done){b.promise.done(b.done)}return b.promise};(function(b){var a={};var c={mode:"horizontal",slideSelector:"",infiniteLoop:true,hideControlOnEnd:false,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:false,captions:false,ticker:false,tickerHover:false,adaptiveHeight:false,adaptiveHeightSpeed:500,video:false,useCSS:true,preloadImages:"visible",responsive:true,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:true,swipeThreshold:50,oneToOneTouch:true,preventDefaultSwipeX:true,preventDefaultSwipeY:false,pager:true,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:true,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:false,startText:"Start",stopText:"Stop",autoControlsCombine:false,autoControlsSelector:null,auto:false,pause:4000,autoStart:true,autoDirection:"next",autoHover:false,autoDelay:0,autoSlideForOnePage:false,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onSliderResize:function(){}};b.fn.bxSlider=function(t){if(this.length==0){return this}if(this.length>1){this.each(function(){b(this).bxSlider(t)});return this}var j={};var I=this;a.el=this;var K=b(window).width();var N=b(window).height();var D=function(){j.settings=b.extend({},c,t);j.settings.slideWidth=parseInt(j.settings.slideWidth);j.children=I.children(j.settings.slideSelector);if(j.children.length<j.settings.minSlides){j.settings.minSlides=j.children.length}if(j.children.length<j.settings.maxSlides){j.settings.maxSlides=j.children.length}if(j.settings.randomStart){j.settings.startSlide=Math.floor(Math.random()*j.children.length)}j.active={index:j.settings.startSlide};j.carousel=j.settings.minSlides>1||j.settings.maxSlides>1;if(j.carousel){j.settings.preloadImages="all"}j.minThreshold=(j.settings.minSlides*j.settings.slideWidth)+((j.settings.minSlides-1)*j.settings.slideMargin);j.maxThreshold=(j.settings.maxSlides*j.settings.slideWidth)+((j.settings.maxSlides-1)*j.settings.slideMargin);j.working=false;j.controls={};j.interval=null;j.animProp=j.settings.mode=="vertical"?"top":"left";j.usingCSS=j.settings.useCSS&&j.settings.mode!="fade"&&(function(){var U=document.createElement("div");var T=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var S in T){if(U.style[T[S]]!==undefined){j.cssPrefix=T[S].replace("Perspective","").toLowerCase();j.animProp="-"+j.cssPrefix+"-transform";return true}}return false}());if(j.settings.mode=="vertical"){j.settings.maxSlides=j.settings.minSlides}I.data("origStyle",I.attr("style"));I.children(j.settings.slideSelector).each(function(){b(this).data("origStyle",b(this).attr("style"))});m()};var m=function(){I.wrap('<div class="'+j.settings.wrapperClass+'"><div class="bx-viewport"></div></div>');j.viewport=I.parent();j.loader=b('<div class="bx-loading" />');j.viewport.prepend(j.loader);I.css({width:j.settings.mode=="horizontal"?(j.children.length*100+215)+"%":"auto",position:"relative"});if(j.usingCSS&&j.settings.easing){I.css("-"+j.cssPrefix+"-transition-timing-function",j.settings.easing)}else{if(!j.settings.easing){j.settings.easing="swing"}}var S=B();j.viewport.css({width:"100%",overflow:"hidden",position:"relative"});j.viewport.parent().css({maxWidth:M()});if(!j.settings.pager){j.viewport.parent().css({margin:"0 auto 0px"})}j.children.css({"float":j.settings.mode=="horizontal"?"left":"none",listStyle:"none",position:"relative"});j.children.css("width",E());if(j.settings.mode=="horizontal"&&j.settings.slideMargin>0){j.children.css("marginRight",j.settings.slideMargin)}if(j.settings.mode=="vertical"&&j.settings.slideMargin>0){j.children.css("marginBottom",j.settings.slideMargin)}if(j.settings.mode=="fade"){j.children.css({position:"absolute",zIndex:0,display:"none"});j.children.eq(j.settings.startSlide).css({zIndex:j.settings.slideZIndex,display:"block"})}j.controls.el=b('<div class="bx-controls" />');if(j.settings.captions){A()}j.active.last=j.settings.startSlide==w()-1;if(j.settings.video){I.fitVids()}var T=j.children.eq(j.settings.startSlide);if(j.settings.preloadImages=="all"){T=j.children}if(!j.settings.ticker){if(j.settings.pager){P()}if(j.settings.controls){k()}if(j.settings.auto&&j.settings.autoControls){L()}if(j.settings.controls||j.settings.autoControls||j.settings.pager){j.viewport.after(j.controls.el)}}else{j.settings.pager=false}d(T,u)};var d=function(S,V){var U=S.find("img, iframe").length;if(U==0){V();return}var T=0;S.find("img, iframe").each(function(){b(this).one("load",function(){if(++T==U){V()}}).each(function(){if(this.complete){b(this).load()}})})};var u=function(){if(j.settings.infiniteLoop&&j.settings.mode!="fade"&&!j.settings.ticker){var U=j.settings.mode=="vertical"?j.settings.minSlides:j.settings.maxSlides;var T=j.children.slice(0,U).clone().addClass("bx-clone");var S=j.children.slice(-U).clone().addClass("bx-clone");I.append(T).prepend(S)}j.loader.remove();h();if(j.settings.mode=="vertical"){j.settings.adaptiveHeight=true}j.viewport.height(o());I.redrawSlider();j.settings.onSliderLoad(j.active.index);j.initialized=true;if(j.settings.responsive){b(window).bind("resize",n)}if(j.settings.auto&&j.settings.autoStart&&(w()>1||j.settings.autoSlideForOnePage)){e()}if(j.settings.ticker){G()}if(j.settings.pager){R(j.settings.startSlide)}if(j.settings.controls){l()}if(j.settings.touchEnabled&&!j.settings.ticker){f()}};var o=function(){var S=0;var U=b();if(j.settings.mode!="vertical"&&!j.settings.adaptiveHeight){U=j.children}else{if(!j.carousel){U=j.children.eq(j.active.index)}else{var T=j.settings.moveSlides==1?j.active.index:j.active.index*q();U=j.children.eq(T);for(i=1;i<=j.settings.maxSlides-1;i++){if(T+i>=j.children.length){U=U.add(j.children.eq(i-1))}else{U=U.add(j.children.eq(T+i))}}}}if(j.settings.mode=="vertical"){U.each(function(V){S+=b(this).outerHeight()});if(j.settings.slideMargin>0){S+=j.settings.slideMargin*(j.settings.minSlides-1)}}else{S=Math.max.apply(Math,U.map(function(){return b(this).outerHeight(false)}).get())}if(j.viewport.css("box-sizing")=="border-box"){S+=parseFloat(j.viewport.css("padding-top"))+parseFloat(j.viewport.css("padding-bottom"))+parseFloat(j.viewport.css("border-top-width"))+parseFloat(j.viewport.css("border-bottom-width"))}else{if(j.viewport.css("box-sizing")=="padding-box"){S+=parseFloat(j.viewport.css("padding-top"))+parseFloat(j.viewport.css("padding-bottom"))}}return S};var M=function(){var S="100%";if(j.settings.slideWidth>0){if(j.settings.mode=="horizontal"){S=(j.settings.maxSlides*j.settings.slideWidth)+((j.settings.maxSlides-1)*j.settings.slideMargin)}else{S=j.settings.slideWidth}}return S};var E=function(){var T=j.settings.slideWidth;var S=j.viewport.width();if(j.settings.slideWidth==0||(j.settings.slideWidth>S&&!j.carousel)||j.settings.mode=="vertical"){T=S}else{if(j.settings.maxSlides>1&&j.settings.mode=="horizontal"){if(S>j.maxThreshold){}else{if(S<j.minThreshold){T=(S-(j.settings.slideMargin*(j.settings.minSlides-1)))/j.settings.minSlides}}}}return T};var B=function(){var T=1;if(j.settings.mode=="horizontal"&&j.settings.slideWidth>0){if(j.viewport.width()<j.minThreshold){T=j.settings.minSlides}else{if(j.viewport.width()>j.maxThreshold){T=j.settings.maxSlides}else{var S=j.children.first().width()+j.settings.slideMargin;T=Math.floor((j.viewport.width()+j.settings.slideMargin)/S)}}}else{if(j.settings.mode=="vertical"){T=j.settings.minSlides}}return T};var w=function(){var T=0;if(j.settings.moveSlides>0){if(j.settings.infiniteLoop){T=Math.ceil(j.children.length/q())}else{var U=0;var S=0;while(U<j.children.length){++T;U=S+B();S+=j.settings.moveSlides<=B()?j.settings.moveSlides:B()}}}else{T=Math.ceil(j.children.length/B())}return T};var q=function(){if(j.settings.moveSlides>0&&j.settings.moveSlides<=B()){return j.settings.moveSlides}return B()};var h=function(){if(j.children.length>j.settings.maxSlides&&j.active.last&&!j.settings.infiniteLoop){if(j.settings.mode=="horizontal"){var U=j.children.last();var S=U.position();C(-(S.left-(j.viewport.width()-U.outerWidth())),"reset",0)}else{if(j.settings.mode=="vertical"){var T=j.children.length-j.settings.minSlides;var S=j.children.eq(T).position();C(-S.top,"reset",0)}}}else{var S=j.children.eq(j.active.index*q()).position();if(j.active.index==w()-1){j.active.last=true}if(S!=undefined){if(j.settings.mode=="horizontal"){C(-S.left,"reset",0)}else{if(j.settings.mode=="vertical"){C(-S.top,"reset",0)}}}}};var C=function(U,T,V,X){if(j.usingCSS){var W=j.settings.mode=="vertical"?"translate3d(0, "+U+"px, 0)":"translate3d("+U+"px, 0, 0)";I.css("-"+j.cssPrefix+"-transition-duration",V/1000+"s");if(T=="slide"){I.css(j.animProp,W);I.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){I.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");p()})}else{if(T=="reset"){I.css(j.animProp,W)}else{if(T=="ticker"){I.css("-"+j.cssPrefix+"-transition-timing-function","linear");I.css(j.animProp,W);I.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){I.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");C(X.resetValue,"reset",0);v()})}}}}else{var S={};S[j.animProp]=U;if(T=="slide"){I.animate(S,V,j.settings.easing,function(){p()})}else{if(T=="reset"){I.css(j.animProp,U)}else{if(T=="ticker"){I.animate(S,speed,"linear",function(){C(X.resetValue,"reset",0);v()})}}}}};var r=function(){var V="";var U=w();for(var T=0;T<U;T++){var S="";if(j.settings.buildPager&&b.isFunction(j.settings.buildPager)){S=j.settings.buildPager(T);j.pagerEl.addClass("bx-custom-pager")}else{S=T+1;j.pagerEl.addClass("bx-default-pager")}V+='<div class="bx-pager-item"><a href="" data-slide-index="'+T+'" class="bx-pager-link">'+S+"</a></div>"}j.pagerEl.html(V)};var P=function(){if(!j.settings.pagerCustom){j.pagerEl=b('<div class="bx-pager" />');if(j.settings.pagerSelector){b(j.settings.pagerSelector).html(j.pagerEl)}else{j.controls.el.addClass("bx-has-pager").append(j.pagerEl)}r()}else{j.pagerEl=b(j.settings.pagerCustom)}j.pagerEl.on("click","a",y)};var k=function(){j.controls.next=b('<a class="bx-next" href="">'+j.settings.nextText+"</a>");j.controls.prev=b('<a class="bx-prev" href="">'+j.settings.prevText+"</a>");j.controls.next.bind("click",g);j.controls.prev.bind("click",O);if(j.settings.nextSelector){b(j.settings.nextSelector).append(j.controls.next)}if(j.settings.prevSelector){b(j.settings.prevSelector).append(j.controls.prev)}if(!j.settings.nextSelector&&!j.settings.prevSelector){j.controls.directionEl=b('<div class="bx-controls-direction" />');j.controls.directionEl.append(j.controls.prev).append(j.controls.next);j.controls.el.addClass("bx-has-controls-direction").append(j.controls.directionEl)}};var L=function(){j.controls.start=b('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+j.settings.startText+"</a></div>");j.controls.stop=b('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+j.settings.stopText+"</a></div>");j.controls.autoEl=b('<div class="bx-controls-auto" />');j.controls.autoEl.on("click",".bx-start",x);j.controls.autoEl.on("click",".bx-stop",Q);if(j.settings.autoControlsCombine){j.controls.autoEl.append(j.controls.start)}else{j.controls.autoEl.append(j.controls.start).append(j.controls.stop)}if(j.settings.autoControlsSelector){b(j.settings.autoControlsSelector).html(j.controls.autoEl)}else{j.controls.el.addClass("bx-has-controls-auto").append(j.controls.autoEl)}H(j.settings.autoStart?"stop":"start")};var A=function(){j.children.each(function(S){var T=b(this).find("img:first").attr("title");if(T!=undefined&&(""+T).length){b(this).append('<div class="bx-caption"><span>'+T+"</span></div>")}})};var g=function(S){if(j.settings.auto){I.stopAuto()}I.goToNextSlide();S.preventDefault()};var O=function(S){if(j.settings.auto){I.stopAuto()}I.goToPrevSlide();S.preventDefault()};var x=function(S){I.startAuto();S.preventDefault()};var Q=function(S){I.stopAuto();S.preventDefault()};var y=function(U){if(j.settings.auto){I.stopAuto()}var T=b(U.currentTarget);if(T.attr("data-slide-index")!==undefined){var S=parseInt(T.attr("data-slide-index"));if(S!=j.active.index){I.goToSlide(S)}U.preventDefault()}};var R=function(T){var S=j.children.length;if(j.settings.pagerType=="short"){if(j.settings.maxSlides>1){S=Math.ceil(j.children.length/j.settings.maxSlides)}j.pagerEl.html((T+1)+j.settings.pagerShortSeparator+S);return}j.pagerEl.find("a").removeClass("active");j.pagerEl.each(function(U,V){b(V).find("a").eq(T).addClass("active")})};var p=function(){if(j.settings.infiniteLoop){var S="";if(j.active.index==0){S=j.children.eq(0).position()}else{if(j.active.index==w()-1&&j.carousel){S=j.children.eq((w()-1)*q()).position()}else{if(j.active.index==j.children.length-1){S=j.children.eq(j.children.length-1).position()}}}if(S){if(j.settings.mode=="horizontal"){C(-S.left,"reset",0)}else{if(j.settings.mode=="vertical"){C(-S.top,"reset",0)}}}}j.working=false;j.settings.onSlideAfter(j.children.eq(j.active.index),j.oldIndex,j.active.index)};var H=function(S){if(j.settings.autoControlsCombine){j.controls.autoEl.html(j.controls[S])}else{j.controls.autoEl.find("a").removeClass("active");j.controls.autoEl.find("a:not(.bx-"+S+")").addClass("active")}};var l=function(){if(w()==1){j.controls.prev.addClass("disabled");j.controls.next.addClass("disabled")}else{if(!j.settings.infiniteLoop&&j.settings.hideControlOnEnd){if(j.active.index==0){j.controls.prev.addClass("disabled");j.controls.next.removeClass("disabled")}else{if(j.active.index==w()-1){j.controls.next.addClass("disabled");j.controls.prev.removeClass("disabled")}else{j.controls.prev.removeClass("disabled");j.controls.next.removeClass("disabled")}}}}};var e=function(){if(j.settings.autoDelay>0){var S=setTimeout(I.startAuto,j.settings.autoDelay)}else{I.startAuto()}if(j.settings.autoHover){I.hover(function(){if(j.interval){I.stopAuto(true);j.autoPaused=true}},function(){if(j.autoPaused){I.startAuto(true);j.autoPaused=null}})}};var G=function(){var T=0;if(j.settings.autoDirection=="next"){I.append(j.children.clone().addClass("bx-clone"))}else{I.prepend(j.children.clone().addClass("bx-clone"));var S=j.children.first().position();T=j.settings.mode=="horizontal"?-S.left:-S.top}C(T,"reset",0);j.settings.pager=false;j.settings.controls=false;j.settings.autoControls=false;if(j.settings.tickerHover&&!j.usingCSS){j.viewport.hover(function(){I.stop()},function(){var X=0;j.children.each(function(Y){X+=j.settings.mode=="horizontal"?b(this).outerWidth(true):b(this).outerHeight(true)});var U=j.settings.speed/X;var V=j.settings.mode=="horizontal"?"left":"top";var W=U*(X-(Math.abs(parseInt(I.css(V)))));v(W)})}v()};var v=function(X){speed=X?X:j.settings.speed;var S={left:0,top:0};var V={left:0,top:0};if(j.settings.autoDirection=="next"){S=I.find(".bx-clone").first().position()}else{V=j.children.first().position()}var U=j.settings.mode=="horizontal"?-S.left:-S.top;var T=j.settings.mode=="horizontal"?-V.left:-V.top;var W={resetValue:T};C(U,"ticker",speed,W)};var f=function(){j.touch={start:{x:0,y:0},end:{x:0,y:0}};j.viewport.bind("touchstart",F)};var F=function(S){if(j.working){S.preventDefault()}else{j.touch.originalPos=I.position();var T=S.originalEvent;j.touch.start.x=T.changedTouches[0].pageX;j.touch.start.y=T.changedTouches[0].pageY;j.viewport.bind("touchmove",J);j.viewport.bind("touchend",z)}};var J=function(T){var X=T.originalEvent;var U=Math.abs(X.changedTouches[0].pageX-j.touch.start.x);var W=Math.abs(X.changedTouches[0].pageY-j.touch.start.y);if((U*3)>W&&j.settings.preventDefaultSwipeX){T.preventDefault()}else{if((W*3)>U&&j.settings.preventDefaultSwipeY){T.preventDefault()}}if(j.settings.mode!="fade"&&j.settings.oneToOneTouch){var S=0;if(j.settings.mode=="horizontal"){var V=X.changedTouches[0].pageX-j.touch.start.x;S=j.touch.originalPos.left+V}else{var V=X.changedTouches[0].pageY-j.touch.start.y;S=j.touch.originalPos.top+V}C(S,"reset",0)}};var z=function(T){j.viewport.unbind("touchmove",J);var V=T.originalEvent;var S=0;j.touch.end.x=V.changedTouches[0].pageX;j.touch.end.y=V.changedTouches[0].pageY;if(j.settings.mode=="fade"){var U=Math.abs(j.touch.start.x-j.touch.end.x);if(U>=j.settings.swipeThreshold){j.touch.start.x>j.touch.end.x?I.goToNextSlide():I.goToPrevSlide();I.stopAuto()}}else{var U=0;if(j.settings.mode=="horizontal"){U=j.touch.end.x-j.touch.start.x;S=j.touch.originalPos.left}else{U=j.touch.end.y-j.touch.start.y;S=j.touch.originalPos.top}if(!j.settings.infiniteLoop&&((j.active.index==0&&U>0)||(j.active.last&&U<0))){C(S,"reset",200)}else{if(Math.abs(U)>=j.settings.swipeThreshold){U<0?I.goToNextSlide():I.goToPrevSlide();I.stopAuto()}else{C(S,"reset",200)}}}j.viewport.unbind("touchend",z)};var n=function(T){if(!j.initialized){return}var S=b(window).width();var U=b(window).height();if(K!=S||N!=U){K=S;N=U;I.redrawSlider();j.settings.onSliderResize.call(I,j.active.index)}};I.goToSlide=function(W,Y){if(j.working||j.active.index==W){return}j.working=true;j.oldIndex=j.active.index;if(W<0){j.active.index=w()-1}else{if(W>=w()){j.active.index=0}else{j.active.index=W}}j.settings.onSlideBefore(j.children.eq(j.active.index),j.oldIndex,j.active.index);if(Y=="next"){j.settings.onSlideNext(j.children.eq(j.active.index),j.oldIndex,j.active.index)}else{if(Y=="prev"){j.settings.onSlidePrev(j.children.eq(j.active.index),j.oldIndex,j.active.index)}}j.active.last=j.active.index>=w()-1;if(j.settings.pager){R(j.active.index)}if(j.settings.controls){l()}if(j.settings.mode=="fade"){if(j.settings.adaptiveHeight&&j.viewport.height()!=o()){j.viewport.animate({height:o()},j.settings.adaptiveHeightSpeed)}j.children.filter(":visible").fadeOut(j.settings.speed).css({zIndex:0});j.children.eq(j.active.index).css("zIndex",j.settings.slideZIndex+1).fadeIn(j.settings.speed,function(){b(this).css("zIndex",j.settings.slideZIndex);p()})}else{if(j.settings.adaptiveHeight&&j.viewport.height()!=o()){j.viewport.animate({height:o()},j.settings.adaptiveHeightSpeed)}var X=0;var V={left:0,top:0};if(!j.settings.infiniteLoop&&j.carousel&&j.active.last){if(j.settings.mode=="horizontal"){var S=j.children.eq(j.children.length-1);V=S.position();X=j.viewport.width()-S.outerWidth()}else{var U=j.children.length-j.settings.minSlides;V=j.children.eq(U).position()}}else{if(j.carousel&&j.active.last&&Y=="prev"){var aa=j.settings.moveSlides==1?j.settings.maxSlides-q():((w()-1)*q())-(j.children.length-j.settings.maxSlides);var S=I.children(".bx-clone").eq(aa);V=S.position()}else{if(Y=="next"&&j.active.index==0){V=I.find("> .bx-clone").eq(j.settings.maxSlides).position();j.active.last=false}else{if(W>=0){var T=W*q();V=j.children.eq(T).position()}}}}if("undefined"!==typeof(V)&&V!=null){var Z=j.settings.mode=="horizontal"?-(V.left-X):-V.top;C(Z,"slide",j.settings.speed)}}};I.goToNextSlide=function(){if(!j.settings.infiniteLoop&&j.active.last){return}var S=parseInt(j.active.index)+1;I.goToSlide(S,"next")};I.goToPrevSlide=function(){if(!j.settings.infiniteLoop&&j.active.index==0){return}var S=parseInt(j.active.index)-1;I.goToSlide(S,"prev")};I.startAuto=function(S){if(j.interval){return}j.interval=setInterval(function(){j.settings.autoDirection=="next"?I.goToNextSlide():I.goToPrevSlide()},j.settings.pause);if(j.settings.autoControls&&S!=true){H("stop")}};I.stopAuto=function(S){if(!j.interval){return}clearInterval(j.interval);j.interval=null;if(j.settings.autoControls&&S!=true){H("start")}};I.getCurrentSlide=function(){return j.active.index};I.getCurrentSlideElement=function(){return j.children.eq(j.active.index)};I.getSlideCount=function(){return j.children.length};I.redrawSlider=function(){j.children.add(I.find(".bx-clone")).width(E());j.viewport.css("height",o());if(!j.settings.ticker){h()}if(j.active.last){j.active.index=w()-1}if(j.active.index>=w()){j.active.last=true}if(j.settings.pager&&!j.settings.pagerCustom){r();R(j.active.index)}};I.destroySlider=function(){if(!j.initialized){return}j.initialized=false;b(".bx-clone",this).remove();j.children.each(function(){b(this).data("origStyle")!=undefined?b(this).attr("style",b(this).data("origStyle")):b(this).removeAttr("style")});b(this).data("origStyle")!=undefined?this.attr("style",b(this).data("origStyle")):b(this).removeAttr("style");b(this).unwrap().unwrap();if(j.controls.el){j.controls.el.remove()}if(j.controls.next){j.controls.next.remove()}if(j.controls.prev){j.controls.prev.remove()}if(j.pagerEl&&j.settings.controls){j.pagerEl.remove()}b(".bx-caption",this).remove();if(j.controls.autoEl){j.controls.autoEl.remove()}clearInterval(j.interval);if(j.settings.responsive){b(window).unbind("resize",n)}};I.reloadSlider=function(S){if(S!=undefined){t=S}I.destroySlider();D()};D();return this}})(jQuery);