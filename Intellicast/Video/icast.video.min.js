!function(e,t,i,s){"use strict";var a=i.template('<div class="video-feed-wrapper"><div class="video-feed-row"><div class="paging-card prev"><i class="arrow-left"></i></div><div class="video-feed"><ul>{{ _.each(videos, function(video, index){ }}{{ if (isFeed){ video = transform(video.getAmpFormat()); } }}<li><div class="video-menu-item" data-index="{{= index }}" title="{{= video.description }}"><img class="video-item-thumb" src="{{= video.poster }}" height="90" width="160" /><span class="video-item-title">{{= video.description }}</span></div></li>{{ }); }}</ul></div><div class="paging-card next"><i class="arrow-right"></i></div></div></div>'),o=function(){t(this).removeClass("inactive")},n=function(){t(this).addClass("inactive")};e.VideoModel=function(e){i.extend(this,e)},e.VideoModel.constructor=e.VideoModel,e.VideoModel.prototype.getAmpFormat=function(){var e=this.variants.video||this.mezzanine_url;return{"@attributes":{version:"2.0"},channel:{category:"",pubDate:this.lastmodifieddate,language:"en",ttl:"10",item:{title:this.title,link:"http://www.intellicast.com/video/player.aspx",description:this.description,category:"",pubDate:this.lastmodifieddate,guid:this.source_guid,"media-group":{"media-content":[{"@attributes":{isDefault:"true",url:e,type:"video/mp4",medium:"video",duration:this.duration}}],"media-title":this.title,"media-description":this.teaserTitle,"media-thumbnail":{"@attributes":{url:this.variants[9]||this.variants[0]}},"media-embed":{"@attributes":{url:"http://player.js",width:"604",height:"341"},"media-param":{"@attributes":{name:"type"},"#text":"text/javascript"}},"media-subTitle":{"@attributes":{type:"application/ttml+xml",lang:"en",href:""}}}}}}},e.VideoCollection=function(e){this.url=e,this.ajaxConfig={url:e,dataType:"jsonp",jsonp:"jsonp",async:!0},this.collection=[]},e.VideoCollection.constructor=e.VideoCollection,e.VideoCollection.prototype={fetch:function(){var s=this,a=t.Deferred();return t.ajax(this.ajaxConfig).done(function(t){var o=t.body.length?t.body[0].doc:[t.body];i.each(o,function(t){var i=t.flags,a=t.variants.video||t.mezzanine_url;i&&a&&(i["Big Web"]||i["Little Web"])&&s.collection.push(new e.VideoModel(t))}),s.collection.length?a.resolve(s.collection):a.reject({message:"failed to create collection"})}).fail(function(){a.reject(arguments)}),a.promise()}},e.VideoMenu=function(e,t,i){var s=this;this.view=e,this.data=t,this.view.html(this.template({videos:t,isFeed:i,transform:this.transform})),this.items=this.view.find(".video-menu-item"),this.view.find(".video-feed").jcarousel(),this.view.on("click",".video-menu-item",function(e){e.preventDefault(),s.select(this.getAttribute("data-index"))}),this.view.find(".prev").on("jcarouselcontrol:active",o).on("jcarouselcontrol:inactive",n).jcarouselControl({target:"-=3"}),this.view.find(".next").on("jcarouselcontrol:active",o).on("jcarouselcontrol:inactive",n).jcarouselControl({target:"+=3"})},e.VideoMenu.constructor=e.VideoMenu,e.VideoMenu.prototype={view:null,selected:null,selectedIndex:0,value:null,items:null,data:null,setClass:!0,select:function(e){return e=parseInt(e,10),isNaN(e)?!1:(null!==this.selected&&this.setClass&&this.selected.removeClass("selected"),e>=this.data.length&&(e=0),0>e&&(e=this.data.length-1),this.selectedIndex=e,this.selected=this.items.eq(this.selectedIndex),this.view.find(".video-feed").jcarousel("scroll",e),this.setClass&&(this.selected.addClass("selected"),this.view.find(".up-next").removeClass("up-next"),this.items.eq(this.selectedIndex+1).addClass("up-next")),void(this.value=this.data[this.selectedIndex]))},transform:function(e){var t,i,s;return t=e.channel.item.length>0?e.channel.item[0]:e.channel.item,i=t["media-thumbnail"]||t["media-group"]["media-thumbnail"],s=t["media-description"]||t["media-group"]["media-description"],i&&i["@attributes"]&&(i=i["@attributes"].url),{title:t.title,poster:i,description:s}},template:a},e.VideoPlayer=function(e){this.view=e},e.VideoPlayer.constructor=e.VideoPlayer,e.VideoPlayer.prototype={amp:null,initAmp:function(e,t,i){s.amp.AMP.loadDefaults("amp.premier/amp.premier.html"),this.amp=new s.amp.AMP(e,t,i)},loadVideo:function(e){this.view.find(".video-title").html(e.title||""),this.view.find(".video-desc").html(e.description||""),this.amp.feed.setData(e.getAmpFormat())}}}(window.Icast=Icast||{},jQuery,_,akamai);