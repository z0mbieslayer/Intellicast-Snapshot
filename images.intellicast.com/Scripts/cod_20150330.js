var COD=function(){function r(){var t,r,u,i=function(){localStorage.setItem("codTimeStamp",JSON.stringify((new Date).getTime()))};if(t=localStorage.getItem("codTimeStamp"),!t){i();n();return}if(t=parseInt(t,10),r=new Date,u=r.getTime()-t,u>=3e5){i();n(!0);return}i();n()}function n(n){var r=localStorage.getItem("codCache");if(r||i(),r=JSON.parse(r),r&&r.metadata.latitude==cod.latitude&&r.metadata.longitude==cod.longitude&&!n){(cod.unit=="F"&&r.metadata.units!="e"||cod.unit==="C"&&r.metadata.units!=="m")&&i();u(r);t(r);return}i()}function u(n){var t="imperial"in n.observation?n.observation.imperial.temp:n.observation.metric.temp;$("#recentTemp").html(t+"&deg; ")}function t(n){var t=function(n){return n.observation&&(n.observation.icon_code={D:{"0":"89","3":"84","4":"84","5":"79","6":"79","7":"79","8":"90","9":"76","10":"89","11":"87","12":"82","13":"77","14":"74","16":"83","18":"88","20":"70","24":"78","26":"67","27":"69","28":"69","29":"66","30":"66","31":"85","32":"85","33":"65","34":"65","37":"95","38":"96","39":"87","40":"82","41":"74","42":"83","43":"80","44":"86","45":"87","46":"74","47":"95"},N:{"0":"112","3":"116","4":"116","5":"113","6":"113","7":"113","8":"111","9":"105","10":"112","11":"106","12":"107","13":"108","14":"114","16":"109","18":"110","20":"104","24":"78","26":"103","27":"98","28":"98","29":"98","30":"98","31":"97","32":"97","33":"97","34":"97","37":"116","38":"96","39":"106","40":"107","41":"109","42":"109","43":"80","44":"86","45":"107","46":"109","47":"116"},X:{"44":"86"}}[n.observation.day_ind][n.observation.icon_code]||"86"),n},i=function(n){var t,r,u;if(!n.observation&&!n.observation.obs_time_local)return"NA";var i=new Date(n.observation.obs_time_local);return isNaN(i.getDay())&&(i=new Date(n.observation.obs_time_local.replace(/\-/g,"index.html").split("T")[0])),t=n.observation.obs_time_local.split("T")[1].split(":"),r=parseInt(t[0],10)>=12?" PM":" AM",t.pop(),t[0]=parseInt(t[0],10)>12?parseInt(t[0],10)-12+"":parseInt(t[0],10)<10?t[0].substring(1):t[0],u=[t.join(":"),r," on ",["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][i.getDay()]," ",i.getDate()," ",["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i.getMonth()]," ",i.getFullYear()," (Local Time)"],n.observation.print_time_local=u.join(""),n};try{$("#conditions_report").html(_.template("As of {{= observation.print_time_local }}")(i(n)));$("#conditions_view").html(_.template($("#current-conditions-template").html())(t(n)))}catch(r){}}function f(){$("#conditions_view").style("text-align","center").html("Oops!Something went wrong fetching the current conditions data<br />please refresh the page to try again.")}function i(){var i=cod.unit?cod.unit==="F"?"e":"m":"e",n={url:undefined,dataType:"json",async:!0,xhrFields:{withCredentials:!1}};n.url="http://api.weather.com/v1/geocode/{lat}/{lon}/observations/current.json?apiKey={apikey}&language={lang}&units={unit}".replace("{lat}",cod.latitude).replace("{lon}",cod.longitude).replace("{apikey}","927977ae89d7e1a709571a585f1f46ca").replace("{lang}","en-US").replace("{unit}",i);$.ajax(n).done(function(r){if(localStorage.setItem("codCache",JSON.stringify(r)),u(r),i==="e")window.localStorage.setItem("relative_humidity",r.observation.imperial.rh);else if(window.localStorage.getItem("relative_humidity"))r.observation.metric.rh=window.localStorage.getItem("relative_humidity");else{n.url=n.url.replace("units=m","units=e");$.ajax(n).done(function(n){window.localStorage.setItem("relative_humidity",n.observation.imperial.rh);r.observation.metric.rh=n.observation.imperial.rh;t(r)});return}t(r)}).fail(f)}$(function(){r();setInterval(r,3e5)})}();